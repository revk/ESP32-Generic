<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Interactive BOM for KiCAD</title>
  <style type="text/css">
:root {
  --pcb-edge-color: black;
  --pad-color: #878787;
  --pad-hole-color: #CCCCCC;
  --pad-color-highlight: #D04040;
  --pad-color-highlight-both: #D0D040;
  --pad-color-highlight-marked: #44a344;
  --pin1-outline-color: #ffb629;
  --pin1-outline-color-highlight: #ffb629;
  --pin1-outline-color-highlight-both: #fcbb39;
  --pin1-outline-color-highlight-marked: #fdbe41;
  --silkscreen-edge-color: #aa4;
  --silkscreen-polygon-color: #4aa;
  --silkscreen-text-color: #4aa;
  --fabrication-edge-color: #907651;
  --fabrication-polygon-color: #907651;
  --fabrication-text-color: #a27c24;
  --track-color: #def5f1;
  --track-color-highlight: #D04040;
  --zone-color: #def5f1;
  --zone-color-highlight: #d0404080;
}

html,
body {
  margin: 0px;
  height: 100%;
  font-family: Verdana, sans-serif;
}

.dark.topmostdiv {
  --pcb-edge-color: #eee;
  --pad-color: #808080;
  --pin1-outline-color: #ffa800;
  --pin1-outline-color-highlight: #ccff00;
  --track-color: #42524f;
  --zone-color: #42524f;
  background-color: #252c30;
  color: #eee;
}

button {
  background-color: #eee;
  border: 1px solid #888;
  color: black;
  height: 44px;
  width: 44px;
  text-align: center;
  text-decoration: none;
  display: inline-block;
  font-size: 14px;
  font-weight: bolder;
}

.dark button {
  /* This will be inverted */
  background-color: #c3b7b5;
}

button.depressed {
  background-color: #0a0;
  color: white;
}

.dark button.depressed {
  /* This will be inverted */
  background-color: #b3b;
}

button:focus {
  outline: 0;
}

button#tb-btn {
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 8.47 8.47'%3E%3Crect transform='translate(0 -288.53)' ry='1.17' y='288.8' x='.27' height='7.94' width='7.94' fill='%23f9f9f9'/%3E%3Cg transform='translate(0 -288.53)'%3E%3Crect width='7.94' height='7.94' x='.27' y='288.8' ry='1.17' fill='none' stroke='%23000' stroke-width='.4' stroke-linejoin='round'/%3E%3Cpath d='M1.32 290.12h5.82M1.32 291.45h5.82' fill='none' stroke='%23000' stroke-width='.4'/%3E%3Cpath d='M4.37 292.5v4.23M.26 292.63H8.2' fill='none' stroke='%23000' stroke-width='.3'/%3E%3Ctext font-weight='700' font-size='3.17' font-family='sans-serif'%3E%3Ctspan x='1.35' y='295.73'%3EF%3C/tspan%3E%3Ctspan x='5.03' y='295.68'%3EB%3C/tspan%3E%3C/text%3E%3C/g%3E%3C/svg%3E%0A");
}

button#lr-btn {
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 8.47 8.47'%3E%3Crect transform='translate(0 -288.53)' ry='1.17' y='288.8' x='.27' height='7.94' width='7.94' fill='%23f9f9f9'/%3E%3Cg transform='translate(0 -288.53)'%3E%3Crect width='7.94' height='7.94' x='.27' y='288.8' ry='1.17' fill='none' stroke='%23000' stroke-width='.4' stroke-linejoin='round'/%3E%3Cpath d='M1.06 290.12H3.7m-2.64 1.33H3.7m-2.64 1.32H3.7m-2.64 1.3H3.7m-2.64 1.33H3.7' fill='none' stroke='%23000' stroke-width='.4'/%3E%3Cpath d='M4.37 288.8v7.94m0-4.11h3.96' fill='none' stroke='%23000' stroke-width='.3'/%3E%3Ctext font-weight='700' font-size='3.17' font-family='sans-serif'%3E%3Ctspan x='5.11' y='291.96'%3EF%3C/tspan%3E%3Ctspan x='5.03' y='295.68'%3EB%3C/tspan%3E%3C/text%3E%3C/g%3E%3C/svg%3E%0A");
}

button#bom-btn {
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 8.47 8.47'%3E%3Crect transform='translate(0 -288.53)' ry='1.17' y='288.8' x='.27' height='7.94' width='7.94' fill='%23f9f9f9'/%3E%3Cg transform='translate(0 -288.53)' fill='none' stroke='%23000' stroke-width='.4'%3E%3Crect width='7.94' height='7.94' x='.27' y='288.8' ry='1.17' stroke-linejoin='round'/%3E%3Cpath d='M1.59 290.12h5.29M1.59 291.45h5.33M1.59 292.75h5.33M1.59 294.09h5.33M1.59 295.41h5.33'/%3E%3C/g%3E%3C/svg%3E");
}

button#bom-grouped-btn {
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='32' height='32'%3E%3Cg stroke='%23000' stroke-linejoin='round' class='layer'%3E%3Crect width='29' height='29' x='1.5' y='1.5' stroke-width='2' fill='%23fff' rx='5' ry='5'/%3E%3Cpath stroke-linecap='square' stroke-width='2' d='M6 10h4m4 0h5m4 0h3M6.1 22h3m3.9 0h5m4 0h4m-16-8h4m4 0h4'/%3E%3Cpath stroke-linecap='null' d='M5 17.5h22M5 26.6h22M5 5.5h22'/%3E%3C/g%3E%3C/svg%3E");
}

button#bom-ungrouped-btn {
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='32' height='32'%3E%3Cg stroke='%23000' stroke-linejoin='round' class='layer'%3E%3Crect width='29' height='29' x='1.5' y='1.5' stroke-width='2' fill='%23fff' rx='5' ry='5'/%3E%3Cpath stroke-linecap='square' stroke-width='2' d='M6 10h4m-4 8h3m-3 8h4'/%3E%3Cpath stroke-linecap='null' d='M5 13.5h22m-22 8h22M5 5.5h22'/%3E%3C/g%3E%3C/svg%3E");
}

button#bom-netlist-btn {
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='32' height='32'%3E%3Cg fill='none' stroke='%23000' class='layer'%3E%3Crect width='29' height='29' x='1.5' y='1.5' stroke-width='2' fill='%23fff' rx='5' ry='5'/%3E%3Cpath stroke-width='2' d='M6 26l6-6v-8m13.8-6.3l-6 6v8'/%3E%3Ccircle cx='11.8' cy='9.5' r='2.8' stroke-width='2'/%3E%3Ccircle cx='19.8' cy='22.8' r='2.8' stroke-width='2'/%3E%3C/g%3E%3C/svg%3E");
}

button#copy {
  background-image: url("data:image/svg+xml,%3Csvg height='48' viewBox='0 0 48 48' width='48' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M0 0h48v48h-48z' fill='none'/%3E%3Cpath d='M32 2h-24c-2.21 0-4 1.79-4 4v28h4v-28h24v-4zm6 8h-22c-2.21 0-4 1.79-4 4v28c0 2.21 1.79 4 4 4h22c2.21 0 4-1.79 4-4v-28c0-2.21-1.79-4-4-4zm0 32h-22v-28h22v28z'/%3E%3C/svg%3E");
  background-position: 6px 6px;
  background-repeat: no-repeat;
  background-size: 26px 26px;
  border-radius: 6px;
  height: 40px;
  width: 40px;
  margin: 10px 5px;
}

button#copy:active {
  box-shadow: inset 0px 0px 5px #6c6c6c;
}

textarea.clipboard-temp {
  position: fixed;
  top: 0;
  left: 0;
  width: 2em;
  height: 2em;
  padding: 0;
  border: None;
  outline: None;
  box-shadow: None;
  background: transparent;
}

.left-most-button {
  border-right: 0;
  border-top-left-radius: 6px;
  border-bottom-left-radius: 6px;
}

.middle-button {
  border-right: 0;
}

.right-most-button {
  border-top-right-radius: 6px;
  border-bottom-right-radius: 6px;
}

.button-container {
  font-size: 0;
  margin: 10px 10px 10px 0px;
}

.dark .button-container {
  filter: invert(1);
}

.button-container button {
  background-size: 32px 32px;
  background-position: 5px 5px;
  background-repeat: no-repeat;
}

@media print {
  .hideonprint {
    display: none;
  }
}

canvas {
  cursor: crosshair;
}

canvas:active {
  cursor: grabbing;
}

.fileinfo {
  width: 100%;
  max-width: 1000px;
  border: none;
  padding: 5px;
}

.fileinfo .title {
  font-size: 20pt;
  font-weight: bold;
}

.fileinfo td {
  overflow: hidden;
  white-space: nowrap;
  max-width: 1px;
  width: 50%;
  text-overflow: ellipsis;
}

.bom {
  border-collapse: collapse;
  font-family: Consolas, "DejaVu Sans Mono", Monaco, monospace;
  font-size: 10pt;
  table-layout: fixed;
  width: 100%;
  margin-top: 1px;
  position: relative;
}

.bom th,
.bom td {
  border: 1px solid black;
  padding: 5px;
  word-wrap: break-word;
  text-align: center;
  position: relative;
}

.dark .bom th,
.dark .bom td {
  border: 1px solid #777;
}

.bom th {
  background-color: #CCCCCC;
  background-clip: padding-box;
}

.dark .bom th {
  background-color: #3b4749;
}

.bom tr.highlighted:nth-child(n) {
  background-color: #cfc;
}

.dark .bom tr.highlighted:nth-child(n) {
  background-color: #226022;
}

.bom tr:nth-child(even) {
  background-color: #f2f2f2;
}

.dark .bom tr:nth-child(even) {
  background-color: #313b40;
}

.bom tr.checked {
  color: #1cb53d;
}

.dark .bom tr.checked {
  color: #2cce54;
}

.bom tr {
  transition: background-color 0.2s;
}

.bom .numCol {
  width: 30px;
}

.bom .value {
  width: 15%;
}

.bom .quantity {
  width: 65px;
}

.bom th .sortmark {
  position: absolute;
  right: 1px;
  top: 1px;
  margin-top: -5px;
  border-width: 5px;
  border-style: solid;
  border-color: transparent transparent #221 transparent;
  transform-origin: 50% 85%;
  transition: opacity 0.2s, transform 0.4s;
}

.dark .bom th .sortmark {
  filter: invert(1);
}

.bom th .sortmark.none {
  opacity: 0;
}

.bom th .sortmark.desc {
  transform: rotate(180deg);
}

.bom th:hover .sortmark.none {
  opacity: 0.5;
}

.bom .bom-checkbox {
  width: 30px;
  position: relative;
  user-select: none;
  -moz-user-select: none;
}

.bom .bom-checkbox:before {
  content: "";
  position: absolute;
  border-width: 15px;
  border-style: solid;
  border-color: #51829f transparent transparent transparent;
  visibility: hidden;
  top: -15px;
}

.bom .bom-checkbox:after {
  content: "Double click to set/unset all";
  position: absolute;
  color: white;
  top: -35px;
  left: -26px;
  background: #51829f;
  padding: 5px 15px;
  border-radius: 8px;
  white-space: nowrap;
  visibility: hidden;
}

.bom .bom-checkbox:hover:before,
.bom .bom-checkbox:hover:after {
  visibility: visible;
  transition: visibility 0.2s linear 1s;
}

.split {
  -webkit-box-sizing: border-box;
  -moz-box-sizing: border-box;
  box-sizing: border-box;
  overflow-y: auto;
  overflow-x: hidden;
  background-color: inherit;
}

.split.split-horizontal,
.gutter.gutter-horizontal {
  height: 100%;
  float: left;
}

.gutter {
  background-color: #ddd;
  background-repeat: no-repeat;
  background-position: 50%;
  transition: background-color 0.3s;
}

.dark .gutter {
  background-color: #777;
}

.gutter.gutter-horizontal {
  background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAeCAYAAADkftS9AAAAIklEQVQoU2M4c+bMfxAGAgYYmwGrIIiDjrELjpo5aiZeMwF+yNnOs5KSvgAAAABJRU5ErkJggg==');
  cursor: ew-resize;
  width: 5px;
}

.gutter.gutter-vertical {
  background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAFAQMAAABo7865AAAABlBMVEVHcEzMzMzyAv2sAAAAAXRSTlMAQObYZgAAABBJREFUeF5jOAMEEAIEEFwAn3kMwcB6I2AAAAAASUVORK5CYII=');
  cursor: ns-resize;
  height: 5px;
}

.searchbox {
  float: left;
  height: 40px;
  margin: 10px 5px;
  padding: 12px 32px;
  font-family: Consolas, "DejaVu Sans Mono", Monaco, monospace;
  font-size: 18px;
  box-sizing: border-box;
  border: 1px solid #888;
  border-radius: 6px;
  outline: none;
  background-color: #eee;
  transition: background-color 0.2s, border 0.2s;
  background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAABNklEQVQ4T8XSMUvDQBQH8P/LElFa/AIZHcTBQSz0I/gFstTBRR2KUC4ldDxw7h0Bl3RRUATxi4iiODgoiLNrbQYp5J6cpJJqomkX33Z37/14d/dIa33MzDuYI4johOI4XhyNRteO46zNYjDzAxE1yBZprVeZ+QbAUhXEGJMA2Ox2u4+fQIa0mPmsCgCgJYQ4t7lfgF0opQYAdv9ABkKI/UnOFCClXKjX61cA1osQY8x9kiRNKeV7IWA3oyhaSdP0FkAtjxhj3hzH2RBCPOf3pzqYHCilfAAX+URm9oMguPzeWSGQvUcMYC8rOBJCHBRdqxTo9/vbRHRqi8bj8XKv1xvODbiuW2u32/bvf0SlDv4XYOY7z/Mavu+nM1+BmQ+NMc0wDF/LprP0DbTWW0T00ul0nn4b7Q87+X4Qmfiq2wAAAABJRU5ErkJggg==');
  background-position: 10px 10px;
  background-repeat: no-repeat;
}

.dark .searchbox {
  background-color: #111;
  color: #eee;
}

.searchbox::placeholder {
  color: #ccc;
}

.dark .searchbox::placeholder {
  color: #666;
}

.filter {
  width: calc(60% - 64px);
}

.reflookup {
  width: calc(40% - 10px);
}

input[type=text]:focus {
  background-color: white;
  border: 1px solid #333;
}

.dark input[type=text]:focus {
  background-color: #333;
  border: 1px solid #ccc;
}

mark.highlight {
  background-color: #5050ff;
  color: #fff;
  padding: 2px;
  border-radius: 6px;
}

.dark mark.highlight {
  background-color: #76a6da;
  color: #111;
}

.menubtn {
  background-color: white;
  border: none;
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='36' height='36' viewBox='0 0 20 20'%3E%3Cpath fill='none' d='M0 0h20v20H0V0z'/%3E%3Cpath d='M15.95 10.78c.03-.25.05-.51.05-.78s-.02-.53-.06-.78l1.69-1.32c.15-.12.19-.34.1-.51l-1.6-2.77c-.1-.18-.31-.24-.49-.18l-1.99.8c-.42-.32-.86-.58-1.35-.78L12 2.34c-.03-.2-.2-.34-.4-.34H8.4c-.2 0-.36.14-.39.34l-.3 2.12c-.49.2-.94.47-1.35.78l-1.99-.8c-.18-.07-.39 0-.49.18l-1.6 2.77c-.1.18-.06.39.1.51l1.69 1.32c-.04.25-.07.52-.07.78s.02.53.06.78L2.37 12.1c-.15.12-.19.34-.1.51l1.6 2.77c.1.18.31.24.49.18l1.99-.8c.42.32.86.58 1.35.78l.3 2.12c.04.2.2.34.4.34h3.2c.2 0 .37-.14.39-.34l.3-2.12c.49-.2.94-.47 1.35-.78l1.99.8c.18.07.39 0 .49-.18l1.6-2.77c.1-.18.06-.39-.1-.51l-1.67-1.32zM10 13c-1.65 0-3-1.35-3-3s1.35-3 3-3 3 1.35 3 3-1.35 3-3 3z'/%3E%3C/svg%3E%0A");
  background-position: center;
  background-repeat: no-repeat;
}

.statsbtn {
  background-color: white;
  border: none;
  background-image: url("data:image/svg+xml,%3Csvg width='36' height='36' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M4 6h28v24H4V6zm0 8h28v8H4m9-16v24h10V5.8' fill='none' stroke='%23000' stroke-width='2'/%3E%3C/svg%3E");
  background-position: center;
  background-repeat: no-repeat;
}

.iobtn {
  background-color: white;
  border: none;
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='36' height='36'%3E%3Cpath fill='none' stroke='%23000' stroke-width='2' d='M3 33v-7l6.8-7h16.5l6.7 7v7H3zM3.2 26H33M21 9l5-5.9 5 6h-2.5V15h-5V9H21zm-4.9 0l-5 6-5-6h2.5V3h5v6h2.5z'/%3E%3Cpath fill='none' stroke='%23000' d='M6.1 29.5H10'/%3E%3C/svg%3E");
  background-position: center;
  background-repeat: no-repeat;
}

.visbtn {
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24'%3E%3Cpath fill='none' stroke='%23333' d='M2.5 4.5h5v15h-5zM9.5 4.5h5v15h-5zM16.5 4.5h5v15h-5z'/%3E%3C/svg%3E");
  background-position: center;
  background-repeat: no-repeat;
  padding: 15px;
}

#vismenu-content {
  left: 0px;
  font-family: Verdana, sans-serif;
}

.dark .statsbtn,
.dark .savebtn,
.dark .menubtn,
.dark .iobtn,
.dark .visbtn {
  filter: invert(1);
}

.flexbox {
  display: flex;
  align-items: center;
  justify-content: space-between;
  width: 100%;
}

.savebtn {
  background-color: #d6d6d6;
  width: auto;
  height: 30px;
  flex-grow: 1;
  margin: 5px;
  border-radius: 4px;
}

.savebtn:active {
  background-color: #0a0;
  color: white;
}

.dark .savebtn:active {
  /* This will be inverted */
  background-color: #b3b;
}

.stats {
  border-collapse: collapse;
  font-size: 12pt;
  table-layout: fixed;
  width: 100%;
  min-width: 450px;
}

.dark .stats td {
  border: 1px solid #bbb;
}

.stats td {
  border: 1px solid black;
  padding: 5px;
  word-wrap: break-word;
  text-align: center;
  position: relative;
}

#checkbox-stats div {
  position: absolute;
  left: 0;
  top: 0;
  height: 100%;
  width: 100%;
  display: flex;
  align-items: center;
  justify-content: center;
}

#checkbox-stats .bar {
  background-color: rgba(28, 251, 0, 0.6);
}

.menu {
  position: relative;
  display: inline-block;
  margin: 10px 10px 10px 0px;
}

.menu-content {
  font-size: 12pt !important;
  text-align: left !important;
  font-weight: normal !important;
  display: none;
  position: absolute;
  background-color: white;
  right: 0;
  min-width: 300px;
  box-shadow: 0px 8px 16px 0px rgba(0, 0, 0, 0.2);
  z-index: 100;
  padding: 8px;
}

.dark .menu-content {
  background-color: #111;
}

.menu:hover .menu-content {
  display: block;
}

.menu:hover .menubtn,
.menu:hover .iobtn,
.menu:hover .statsbtn {
  background-color: #eee;
}

.menu-label {
  display: inline-block;
  padding: 8px;
  border: 1px solid #ccc;
  border-top: 0;
  width: calc(100% - 18px);
}

.menu-label-top {
  border-top: 1px solid #ccc;
}

.menu-textbox {
  float: left;
  height: 24px;
  margin: 10px 5px;
  padding: 5px 5px;
  font-family: Consolas, "DejaVu Sans Mono", Monaco, monospace;
  font-size: 14px;
  box-sizing: border-box;
  border: 1px solid #888;
  border-radius: 4px;
  outline: none;
  background-color: #eee;
  transition: background-color 0.2s, border 0.2s;
  width: calc(100% - 10px);
}

.menu-textbox.invalid,
.dark .menu-textbox.invalid {
  color: red;
}

.dark .menu-textbox {
  background-color: #222;
  color: #eee;
}

.radio-container {
  margin: 4px;
}

.topmostdiv {
  width: 100%;
  height: 100%;
  background-color: white;
  transition: background-color 0.3s;
}

#top {
  height: 78px;
  border-bottom: 2px solid black;
}

.dark #top {
  border-bottom: 2px solid #ccc;
}

#dbg {
  display: block;
}

::-webkit-scrollbar {
  width: 8px;
}

::-webkit-scrollbar-track {
  background: #aaa;
}

::-webkit-scrollbar-thumb {
  background: #666;
  border-radius: 3px;
}

::-webkit-scrollbar-thumb:hover {
  background: #555;
}

.slider {
  -webkit-appearance: none;
  width: 100%;
  margin: 3px 0;
  padding: 0;
  outline: none;
  opacity: 0.7;
  -webkit-transition: .2s;
  transition: opacity .2s;
  border-radius: 3px;
}

.slider:hover {
  opacity: 1;
}

.slider:focus {
  outline: none;
}

.slider::-webkit-slider-runnable-track {
  -webkit-appearance: none;
  width: 100%;
  height: 8px;
  background: #d3d3d3;
  border-radius: 3px;
  border: none;
}

.slider::-webkit-slider-thumb {
  -webkit-appearance: none;
  width: 15px;
  height: 15px;
  border-radius: 50%;
  background: #0a0;
  cursor: pointer;
  margin-top: -4px;
}

.dark .slider::-webkit-slider-thumb {
  background: #3d3;
}

.slider::-moz-range-thumb {
  width: 15px;
  height: 15px;
  border-radius: 50%;
  background: #0a0;
  cursor: pointer;
}

.slider::-moz-range-track {
  height: 8px;
  background: #d3d3d3;
  border-radius: 3px;
}

.dark .slider::-moz-range-thumb {
  background: #3d3;
}

.slider::-ms-track {
  width: 100%;
  height: 8px;
  border-width: 3px 0;
  background: transparent;
  border-color: transparent;
  color: transparent;
  transition: opacity .2s;
}

.slider::-ms-fill-lower {
  background: #d3d3d3;
  border: none;
  border-radius: 3px;
}

.slider::-ms-fill-upper {
  background: #d3d3d3;
  border: none;
  border-radius: 3px;
}

.slider::-ms-thumb {
  width: 15px;
  height: 15px;
  border-radius: 50%;
  background: #0a0;
  cursor: pointer;
  margin: 0;
}

.shameless-plug {
  font-size: 0.8em;
  text-align: center;
  display: block;
}

a {
  color: #0278a4;
}

.dark a {
  color: #00b9fd;
}

#frontcanvas,
#backcanvas {
  touch-action: none;
}

.placeholder {
  border: 1px dashed #9f9fda !important;
  background-color: #edf2f7 !important;
}

.dragging {
  z-index: 999;
}

.dark .dragging>table>tbody>tr {
  background-color: #252c30;
}

.dark .placeholder {
  filter: invert(1);
}

.column-spacer {
  top: 0;
  left: 0;
  width: calc(100% - 4px);
  position: absolute;
  cursor: pointer;
  user-select: none;
  height: 100%;
}

.column-width-handle {
  top: 0;
  right: 0;
  width: 4px;
  position: absolute;
  cursor: col-resize;
  user-select: none;
  height: 100%;
}

.column-width-handle:hover {
  background-color: #4f99bd;
}


  </style>
  <script type="text/javascript" >
///////////////////////////////////////////////
/*
  Split.js - v1.3.5
  MIT License
  https://github.com/nathancahill/Split.js
*/
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.Split=t()}(this,function(){"use strict";var e=window,t=e.document,n="addEventListener",i="removeEventListener",r="getBoundingClientRect",s=function(){return!1},o=e.attachEvent&&!e[n],a=["","-webkit-","-moz-","-o-"].filter(function(e){var n=t.createElement("div");return n.style.cssText="width:"+e+"calc(9px)",!!n.style.length}).shift()+"calc",l=function(e){return"string"==typeof e||e instanceof String?t.querySelector(e):e};return function(u,c){function z(e,t,n){var i=A(y,t,n);Object.keys(i).forEach(function(t){return e.style[t]=i[t]})}function h(e,t){var n=B(y,t);Object.keys(n).forEach(function(t){return e.style[t]=n[t]})}function f(e){var t=E[this.a],n=E[this.b],i=t.size+n.size;t.size=e/this.size*i,n.size=i-e/this.size*i,z(t.element,t.size,this.aGutterSize),z(n.element,n.size,this.bGutterSize)}function m(e){var t;this.dragging&&((t="touches"in e?e.touches[0][b]-this.start:e[b]-this.start)<=E[this.a].minSize+M+this.aGutterSize?t=E[this.a].minSize+this.aGutterSize:t>=this.size-(E[this.b].minSize+M+this.bGutterSize)&&(t=this.size-(E[this.b].minSize+this.bGutterSize)),f.call(this,t),c.onDrag&&c.onDrag())}function g(){var e=E[this.a].element,t=E[this.b].element;this.size=e[r]()[y]+t[r]()[y]+this.aGutterSize+this.bGutterSize,this.start=e[r]()[G]}function d(){var t=this,n=E[t.a].element,r=E[t.b].element;t.dragging&&c.onDragEnd&&c.onDragEnd(),t.dragging=!1,e[i]("mouseup",t.stop),e[i]("touchend",t.stop),e[i]("touchcancel",t.stop),t.parent[i]("mousemove",t.move),t.parent[i]("touchmove",t.move),delete t.stop,delete t.move,n[i]("selectstart",s),n[i]("dragstart",s),r[i]("selectstart",s),r[i]("dragstart",s),n.style.userSelect="",n.style.webkitUserSelect="",n.style.MozUserSelect="",n.style.pointerEvents="",r.style.userSelect="",r.style.webkitUserSelect="",r.style.MozUserSelect="",r.style.pointerEvents="",t.gutter.style.cursor="",t.parent.style.cursor=""}function S(t){var i=this,r=E[i.a].element,o=E[i.b].element;!i.dragging&&c.onDragStart&&c.onDragStart(),t.preventDefault(),i.dragging=!0,i.move=m.bind(i),i.stop=d.bind(i),e[n]("mouseup",i.stop),e[n]("touchend",i.stop),e[n]("touchcancel",i.stop),i.parent[n]("mousemove",i.move),i.parent[n]("touchmove",i.move),r[n]("selectstart",s),r[n]("dragstart",s),o[n]("selectstart",s),o[n]("dragstart",s),r.style.userSelect="none",r.style.webkitUserSelect="none",r.style.MozUserSelect="none",r.style.pointerEvents="none",o.style.userSelect="none",o.style.webkitUserSelect="none",o.style.MozUserSelect="none",o.style.pointerEvents="none",i.gutter.style.cursor=j,i.parent.style.cursor=j,g.call(i)}function v(e){e.forEach(function(t,n){if(n>0){var i=F[n-1],r=E[i.a],s=E[i.b];r.size=e[n-1],s.size=t,z(r.element,r.size,i.aGutterSize),z(s.element,s.size,i.bGutterSize)}})}function p(){F.forEach(function(e){e.parent.removeChild(e.gutter),E[e.a].element.style[y]="",E[e.b].element.style[y]=""})}void 0===c&&(c={});var y,b,G,E,w=l(u[0]).parentNode,D=e.getComputedStyle(w).flexDirection,U=c.sizes||u.map(function(){return 100/u.length}),k=void 0!==c.minSize?c.minSize:100,x=Array.isArray(k)?k:u.map(function(){return k}),L=void 0!==c.gutterSize?c.gutterSize:10,M=void 0!==c.snapOffset?c.snapOffset:30,O=c.direction||"horizontal",j=c.cursor||("horizontal"===O?"ew-resize":"ns-resize"),C=c.gutter||function(e,n){var i=t.createElement("div");return i.className="gutter gutter-"+n,i},A=c.elementStyle||function(e,t,n){var i={};return"string"==typeof t||t instanceof String?i[e]=t:i[e]=o?t+"%":a+"("+t+"% - "+n+"px)",i},B=c.gutterStyle||function(e,t){return n={},n[e]=t+"px",n;var n};"horizontal"===O?(y="width","clientWidth",b="clientX",G="left","paddingLeft"):"vertical"===O&&(y="height","clientHeight",b="clientY",G="top","paddingTop");var F=[];return E=u.map(function(e,t){var i,s={element:l(e),size:U[t],minSize:x[t]};if(t>0&&(i={a:t-1,b:t,dragging:!1,isFirst:1===t,isLast:t===u.length-1,direction:O,parent:w},i.aGutterSize=L,i.bGutterSize=L,i.isFirst&&(i.aGutterSize=L/2),i.isLast&&(i.bGutterSize=L/2),"row-reverse"===D||"column-reverse"===D)){var a=i.a;i.a=i.b,i.b=a}if(!o&&t>0){var c=C(t,O);h(c,L),c[n]("mousedown",S.bind(i)),c[n]("touchstart",S.bind(i)),w.insertBefore(c,s.element),i.gutter=c}0===t||t===u.length-1?z(s.element,s.size,L/2):z(s.element,s.size,L);var f=s.element[r]()[y];return f<s.minSize&&(s.minSize=f),t>0&&F.push(i),s}),o?{setSizes:v,destroy:p}:{setSizes:v,getSizes:function(){return E.map(function(e){return e.size})},collapse:function(e){if(e===F.length){var t=F[e-1];g.call(t),o||f.call(t,t.size-t.bGutterSize)}else{var n=F[e];g.call(n),o||f.call(n,n.aGutterSize)}},destroy:p}}});

///////////////////////////////////////////////

///////////////////////////////////////////////
// Copyright (c) 2013 Pieroxy <pieroxy@pieroxy.net>
// This work is free. You can redistribute it and/or modify it
// under the terms of the WTFPL, Version 2
// For more information see LICENSE.txt or http://www.wtfpl.net/
//
// For more information, the home page:
// http://pieroxy.net/blog/pages/lz-string/testing.html
//
// LZ-based compression algorithm, version 1.4.4
var LZString=function(){var o=String.fromCharCode,i={};var n={decompressFromBase64:function(o){return null==o?"":""==o?null:n._decompress(o.length,32,function(n){return function(o,n){if(!i[o]){i[o]={};for(var t=0;t<o.length;t++)i[o][o.charAt(t)]=t}return i[o][n]}("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",o.charAt(n))})},_decompress:function(i,n,t){var r,e,a,s,p,u,l,f=[],c=4,d=4,h=3,v="",g=[],m={val:t(0),position:n,index:1};for(r=0;r<3;r+=1)f[r]=r;for(a=0,p=Math.pow(2,2),u=1;u!=p;)s=m.val&m.position,m.position>>=1,0==m.position&&(m.position=n,m.val=t(m.index++)),a|=(s>0?1:0)*u,u<<=1;switch(a){case 0:for(a=0,p=Math.pow(2,8),u=1;u!=p;)s=m.val&m.position,m.position>>=1,0==m.position&&(m.position=n,m.val=t(m.index++)),a|=(s>0?1:0)*u,u<<=1;l=o(a);break;case 1:for(a=0,p=Math.pow(2,16),u=1;u!=p;)s=m.val&m.position,m.position>>=1,0==m.position&&(m.position=n,m.val=t(m.index++)),a|=(s>0?1:0)*u,u<<=1;l=o(a);break;case 2:return""}for(f[3]=l,e=l,g.push(l);;){if(m.index>i)return"";for(a=0,p=Math.pow(2,h),u=1;u!=p;)s=m.val&m.position,m.position>>=1,0==m.position&&(m.position=n,m.val=t(m.index++)),a|=(s>0?1:0)*u,u<<=1;switch(l=a){case 0:for(a=0,p=Math.pow(2,8),u=1;u!=p;)s=m.val&m.position,m.position>>=1,0==m.position&&(m.position=n,m.val=t(m.index++)),a|=(s>0?1:0)*u,u<<=1;f[d++]=o(a),l=d-1,c--;break;case 1:for(a=0,p=Math.pow(2,16),u=1;u!=p;)s=m.val&m.position,m.position>>=1,0==m.position&&(m.position=n,m.val=t(m.index++)),a|=(s>0?1:0)*u,u<<=1;f[d++]=o(a),l=d-1,c--;break;case 2:return g.join("")}if(0==c&&(c=Math.pow(2,h),h++),f[l])v=f[l];else{if(l!==d)return null;v=e+e.charAt(0)}g.push(v),f[d++]=e+v.charAt(0),e=v,0==--c&&(c=Math.pow(2,h),h++)}}};return n}();"function"==typeof define&&define.amd?define(function(){return LZString}):"undefined"!=typeof module&&null!=module?module.exports=LZString:"undefined"!=typeof angular&&null!=angular&&angular.module("LZString",[]).factory("LZString",function(){return LZString});
///////////////////////////////////////////////

///////////////////////////////////////////////
/*!
 * PEP v0.4.3 | https://github.com/jquery/PEP
 * Copyright jQuery Foundation and other contributors | http://jquery.org/license
 */
!function(a,b){"object"==typeof exports&&"undefined"!=typeof module?module.exports=b():"function"==typeof define&&define.amd?define(b):a.PointerEventsPolyfill=b()}(this,function(){"use strict";function a(a,b){b=b||Object.create(null);var c=document.createEvent("Event");c.initEvent(a,b.bubbles||!1,b.cancelable||!1);
for(var d,e=2;e<m.length;e++)d=m[e],c[d]=b[d]||n[e];c.buttons=b.buttons||0;
var f=0;return f=b.pressure&&c.buttons?b.pressure:c.buttons?.5:0,c.x=c.clientX,c.y=c.clientY,c.pointerId=b.pointerId||0,c.width=b.width||0,c.height=b.height||0,c.pressure=f,c.tiltX=b.tiltX||0,c.tiltY=b.tiltY||0,c.twist=b.twist||0,c.tangentialPressure=b.tangentialPressure||0,c.pointerType=b.pointerType||"",c.hwTimestamp=b.hwTimestamp||0,c.isPrimary=b.isPrimary||!1,c}function b(){this.array=[],this.size=0}function c(a,b,c,d){this.addCallback=a.bind(d),this.removeCallback=b.bind(d),this.changedCallback=c.bind(d),A&&(this.observer=new A(this.mutationWatcher.bind(this)))}function d(a){return"body /shadow-deep/ "+e(a)}function e(a){return'[touch-action="'+a+'"]'}function f(a){return"{ -ms-touch-action: "+a+"; touch-action: "+a+"; }"}function g(){if(F){D.forEach(function(a){String(a)===a?(E+=e(a)+f(a)+"\n",G&&(E+=d(a)+f(a)+"\n")):(E+=a.selectors.map(e)+f(a.rule)+"\n",G&&(E+=a.selectors.map(d)+f(a.rule)+"\n"))});var a=document.createElement("style");a.textContent=E,document.head.appendChild(a)}}function h(){if(!window.PointerEvent){if(window.PointerEvent=a,window.navigator.msPointerEnabled){var b=window.navigator.msMaxTouchPoints;Object.defineProperty(window.navigator,"maxTouchPoints",{value:b,enumerable:!0}),u.registerSource("ms",_)}else Object.defineProperty(window.navigator,"maxTouchPoints",{value:0,enumerable:!0}),u.registerSource("mouse",N),void 0!==window.ontouchstart&&u.registerSource("touch",V);u.register(document)}}function i(a){if(!u.pointermap.has(a)){var b=new Error("InvalidPointerId");throw b.name="InvalidPointerId",b}}function j(a){for(var b=a.parentNode;b&&b!==a.ownerDocument;)b=b.parentNode;if(!b){var c=new Error("InvalidStateError");throw c.name="InvalidStateError",c}}function k(a){var b=u.pointermap.get(a);return 0!==b.buttons}function l(){window.Element&&!Element.prototype.setPointerCapture&&Object.defineProperties(Element.prototype,{setPointerCapture:{value:W},releasePointerCapture:{value:X},hasPointerCapture:{value:Y}})}
var m=["bubbles","cancelable","view","detail","screenX","screenY","clientX","clientY","ctrlKey","altKey","shiftKey","metaKey","button","relatedTarget","pageX","pageY"],n=[!1,!1,null,null,0,0,0,0,!1,!1,!1,!1,0,null,0,0],o=window.Map&&window.Map.prototype.forEach,p=o?Map:b;b.prototype={set:function(a,b){return void 0===b?this["delete"](a):(this.has(a)||this.size++,void(this.array[a]=b))},has:function(a){return void 0!==this.array[a]},"delete":function(a){this.has(a)&&(delete this.array[a],this.size--)},get:function(a){return this.array[a]},clear:function(){this.array.length=0,this.size=0},forEach:function(a,b){return this.array.forEach(function(c,d){a.call(b,c,d,this)},this)}};var q=["bubbles","cancelable","view","detail","screenX","screenY","clientX","clientY","ctrlKey","altKey","shiftKey","metaKey","button","relatedTarget","buttons","pointerId","width","height","pressure","tiltX","tiltY","pointerType","hwTimestamp","isPrimary","type","target","currentTarget","which","pageX","pageY","timeStamp"],r=[!1,!1,null,null,0,0,0,0,!1,!1,!1,!1,0,null,0,0,0,0,0,0,0,"",0,!1,"",null,null,0,0,0,0],s={pointerover:1,pointerout:1,pointerenter:1,pointerleave:1},t="undefined"!=typeof SVGElementInstance,u={pointermap:new p,eventMap:Object.create(null),captureInfo:Object.create(null),eventSources:Object.create(null),eventSourceList:[],registerSource:function(a,b){var c=b,d=c.events;d&&(d.forEach(function(a){c[a]&&(this.eventMap[a]=c[a].bind(c))},this),this.eventSources[a]=c,this.eventSourceList.push(c))},register:function(a){for(var b,c=this.eventSourceList.length,d=0;d<c&&(b=this.eventSourceList[d]);d++)
b.register.call(b,a)},unregister:function(a){for(var b,c=this.eventSourceList.length,d=0;d<c&&(b=this.eventSourceList[d]);d++)
b.unregister.call(b,a)},contains:function(a,b){try{return a.contains(b)}catch(c){return!1}},down:function(a){a.bubbles=!0,this.fireEvent("pointerdown",a)},move:function(a){a.bubbles=!0,this.fireEvent("pointermove",a)},up:function(a){a.bubbles=!0,this.fireEvent("pointerup",a)},enter:function(a){a.bubbles=!1,this.fireEvent("pointerenter",a)},leave:function(a){a.bubbles=!1,this.fireEvent("pointerleave",a)},over:function(a){a.bubbles=!0,this.fireEvent("pointerover",a)},out:function(a){a.bubbles=!0,this.fireEvent("pointerout",a)},cancel:function(a){a.bubbles=!0,this.fireEvent("pointercancel",a)},leaveOut:function(a){this.out(a),this.propagate(a,this.leave,!1)},enterOver:function(a){this.over(a),this.propagate(a,this.enter,!0)},eventHandler:function(a){if(!a._handledByPE){var b=a.type,c=this.eventMap&&this.eventMap[b];c&&c(a),a._handledByPE=!0}},listen:function(a,b){b.forEach(function(b){this.addEvent(a,b)},this)},unlisten:function(a,b){b.forEach(function(b){this.removeEvent(a,b)},this)},addEvent:function(a,b){a.addEventListener(b,this.boundHandler)},removeEvent:function(a,b){a.removeEventListener(b,this.boundHandler)},makeEvent:function(b,c){this.captureInfo[c.pointerId]&&(c.relatedTarget=null);var d=new a(b,c);return c.preventDefault&&(d.preventDefault=c.preventDefault),d._target=d._target||c.target,d},fireEvent:function(a,b){var c=this.makeEvent(a,b);return this.dispatchEvent(c)},cloneEvent:function(a){for(var b,c=Object.create(null),d=0;d<q.length;d++)b=q[d],c[b]=a[b]||r[d],!t||"target"!==b&&"relatedTarget"!==b||c[b]instanceof SVGElementInstance&&(c[b]=c[b].correspondingUseElement);return a.preventDefault&&(c.preventDefault=function(){a.preventDefault()}),c},getTarget:function(a){var b=this.captureInfo[a.pointerId];return b?a._target!==b&&a.type in s?void 0:b:a._target},propagate:function(a,b,c){for(var d=a.target,e=[];d!==document&&!d.contains(a.relatedTarget);) if(e.push(d),d=d.parentNode,!d)return;c&&e.reverse(),e.forEach(function(c){a.target=c,b.call(this,a)},this)},setCapture:function(b,c,d){this.captureInfo[b]&&this.releaseCapture(b,d),this.captureInfo[b]=c,this.implicitRelease=this.releaseCapture.bind(this,b,d),document.addEventListener("pointerup",this.implicitRelease),document.addEventListener("pointercancel",this.implicitRelease);var e=new a("gotpointercapture");e.pointerId=b,e._target=c,d||this.asyncDispatchEvent(e)},releaseCapture:function(b,c){var d=this.captureInfo[b];if(d){this.captureInfo[b]=void 0,document.removeEventListener("pointerup",this.implicitRelease),document.removeEventListener("pointercancel",this.implicitRelease);var e=new a("lostpointercapture");e.pointerId=b,e._target=d,c||this.asyncDispatchEvent(e)}},dispatchEvent:/*scope.external.dispatchEvent || */function(a){var b=this.getTarget(a);if(b)return b.dispatchEvent(a)},asyncDispatchEvent:function(a){requestAnimationFrame(this.dispatchEvent.bind(this,a))}};u.boundHandler=u.eventHandler.bind(u);var v={shadow:function(a){if(a)return a.shadowRoot||a.webkitShadowRoot},canTarget:function(a){return a&&Boolean(a.elementFromPoint)},targetingShadow:function(a){var b=this.shadow(a);if(this.canTarget(b))return b},olderShadow:function(a){var b=a.olderShadowRoot;if(!b){var c=a.querySelector("shadow");c&&(b=c.olderShadowRoot)}return b},allShadows:function(a){for(var b=[],c=this.shadow(a);c;)b.push(c),c=this.olderShadow(c);return b},searchRoot:function(a,b,c){if(a){var d,e,f=a.elementFromPoint(b,c);for(e=this.targetingShadow(f);e;){if(d=e.elementFromPoint(b,c)){var g=this.targetingShadow(d);return this.searchRoot(g,b,c)||d} e=this.olderShadow(e)} return f}},owner:function(a){
for(var b=a;b.parentNode;)b=b.parentNode;
return b.nodeType!==Node.DOCUMENT_NODE&&b.nodeType!==Node.DOCUMENT_FRAGMENT_NODE&&(b=document),b},findTarget:function(a){var b=a.clientX,c=a.clientY,d=this.owner(a.target);
return d.elementFromPoint(b,c)||(d=document),this.searchRoot(d,b,c)}},w=Array.prototype.forEach.call.bind(Array.prototype.forEach),x=Array.prototype.map.call.bind(Array.prototype.map),y=Array.prototype.slice.call.bind(Array.prototype.slice),z=Array.prototype.filter.call.bind(Array.prototype.filter),A=window.MutationObserver||window.WebKitMutationObserver,B="[touch-action]",C={subtree:!0,childList:!0,attributes:!0,attributeOldValue:!0,attributeFilter:["touch-action"]};c.prototype={watchSubtree:function(a){
//
this.observer&&v.canTarget(a)&&this.observer.observe(a,C)},enableOnSubtree:function(a){this.watchSubtree(a),a===document&&"complete"!==document.readyState?this.installOnLoad():this.installNewSubtree(a)},installNewSubtree:function(a){w(this.findElements(a),this.addElement,this)},findElements:function(a){return a.querySelectorAll?a.querySelectorAll(B):[]},removeElement:function(a){this.removeCallback(a)},addElement:function(a){this.addCallback(a)},elementChanged:function(a,b){this.changedCallback(a,b)},concatLists:function(a,b){return a.concat(y(b))},
installOnLoad:function(){document.addEventListener("readystatechange",function(){"complete"===document.readyState&&this.installNewSubtree(document)}.bind(this))},isElement:function(a){return a.nodeType===Node.ELEMENT_NODE},flattenMutationTree:function(a){
var b=x(a,this.findElements,this);
return b.push(z(a,this.isElement)),b.reduce(this.concatLists,[])},mutationWatcher:function(a){a.forEach(this.mutationHandler,this)},mutationHandler:function(a){if("childList"===a.type){var b=this.flattenMutationTree(a.addedNodes);b.forEach(this.addElement,this);var c=this.flattenMutationTree(a.removedNodes);c.forEach(this.removeElement,this)}else"attributes"===a.type&&this.elementChanged(a.target,a.oldValue)}};var D=["none","auto","pan-x","pan-y",{rule:"pan-x pan-y",selectors:["pan-x pan-y","pan-y pan-x"]}],E="",F=window.PointerEvent||window.MSPointerEvent,G=!window.ShadowDOMPolyfill&&document.head.createShadowRoot,H=u.pointermap,I=25,J=[1,4,2,8,16],K=!1;try{K=1===new MouseEvent("test",{buttons:1}).buttons}catch(L){}
var M,N={POINTER_ID:1,POINTER_TYPE:"mouse",events:["mousedown","mousemove","mouseup","mouseover","mouseout"],register:function(a){u.listen(a,this.events)},unregister:function(a){u.unlisten(a,this.events)},lastTouches:[],
isEventSimulatedFromTouch:function(a){for(var b,c=this.lastTouches,d=a.clientX,e=a.clientY,f=0,g=c.length;f<g&&(b=c[f]);f++){
var h=Math.abs(d-b.x),i=Math.abs(e-b.y);if(h<=I&&i<=I)return!0}},prepareEvent:function(a){var b=u.cloneEvent(a),c=b.preventDefault;return b.preventDefault=function(){a.preventDefault(),c()},b.pointerId=this.POINTER_ID,b.isPrimary=!0,b.pointerType=this.POINTER_TYPE,b},prepareButtonsForMove:function(a,b){var c=H.get(this.POINTER_ID);
0!==b.which&&c?a.buttons=c.buttons:a.buttons=0,b.buttons=a.buttons},mousedown:function(a){if(!this.isEventSimulatedFromTouch(a)){var b=H.get(this.POINTER_ID),c=this.prepareEvent(a);K||(c.buttons=J[c.button],b&&(c.buttons|=b.buttons),a.buttons=c.buttons),H.set(this.POINTER_ID,a),b&&0!==b.buttons?u.move(c):u.down(c)}},mousemove:function(a){if(!this.isEventSimulatedFromTouch(a)){var b=this.prepareEvent(a);K||this.prepareButtonsForMove(b,a),b.button=-1,H.set(this.POINTER_ID,a),u.move(b)}},mouseup:function(a){if(!this.isEventSimulatedFromTouch(a)){var b=H.get(this.POINTER_ID),c=this.prepareEvent(a);if(!K){var d=J[c.button];
c.buttons=b?b.buttons&~d:0,a.buttons=c.buttons}H.set(this.POINTER_ID,a),
c.buttons&=~J[c.button],0===c.buttons?u.up(c):u.move(c)}},mouseover:function(a){if(!this.isEventSimulatedFromTouch(a)){var b=this.prepareEvent(a);K||this.prepareButtonsForMove(b,a),b.button=-1,H.set(this.POINTER_ID,a),u.enterOver(b)}},mouseout:function(a){if(!this.isEventSimulatedFromTouch(a)){var b=this.prepareEvent(a);K||this.prepareButtonsForMove(b,a),b.button=-1,u.leaveOut(b)}},cancel:function(a){var b=this.prepareEvent(a);u.cancel(b),this.deactivateMouse()},deactivateMouse:function(){H["delete"](this.POINTER_ID)}},O=u.captureInfo,P=v.findTarget.bind(v),Q=v.allShadows.bind(v),R=u.pointermap,S=2500,T=200,U="touch-action",V={events:["touchstart","touchmove","touchend","touchcancel"],register:function(a){M.enableOnSubtree(a)},unregister:function(){},elementAdded:function(a){var b=a.getAttribute(U),c=this.touchActionToScrollType(b);c&&(a._scrollType=c,u.listen(a,this.events),
Q(a).forEach(function(a){a._scrollType=c,u.listen(a,this.events)},this))},elementRemoved:function(a){a._scrollType=void 0,u.unlisten(a,this.events),
Q(a).forEach(function(a){a._scrollType=void 0,u.unlisten(a,this.events)},this)},elementChanged:function(a,b){var c=a.getAttribute(U),d=this.touchActionToScrollType(c),e=this.touchActionToScrollType(b);
d&&e?(a._scrollType=d,Q(a).forEach(function(a){a._scrollType=d},this)):e?this.elementRemoved(a):d&&this.elementAdded(a)},scrollTypes:{EMITTER:"none",XSCROLLER:"pan-x",YSCROLLER:"pan-y",SCROLLER:/^(?:pan-x pan-y)|(?:pan-y pan-x)|auto$/},touchActionToScrollType:function(a){var b=a,c=this.scrollTypes;return"none"===b?"none":b===c.XSCROLLER?"X":b===c.YSCROLLER?"Y":c.SCROLLER.exec(b)?"XY":void 0},POINTER_TYPE:"touch",firstTouch:null,isPrimaryTouch:function(a){return this.firstTouch===a.identifier},setPrimaryTouch:function(a){
(0===R.size||1===R.size&&R.has(1))&&(this.firstTouch=a.identifier,this.firstXY={X:a.clientX,Y:a.clientY},this.scrolling=!1,this.cancelResetClickCount())},removePrimaryPointer:function(a){a.isPrimary&&(this.firstTouch=null,this.firstXY=null,this.resetClickCount())},clickCount:0,resetId:null,resetClickCount:function(){var a=function(){this.clickCount=0,this.resetId=null}.bind(this);this.resetId=setTimeout(a,T)},cancelResetClickCount:function(){this.resetId&&clearTimeout(this.resetId)},typeToButtons:function(a){var b=0;return"touchstart"!==a&&"touchmove"!==a||(b=1),b},touchToPointer:function(a){var b=this.currentTouchEvent,c=u.cloneEvent(a),d=c.pointerId=a.identifier+2;c.target=O[d]||P(c),c.bubbles=!0,c.cancelable=!0,c.detail=this.clickCount,c.button=0,c.buttons=this.typeToButtons(b.type),c.width=2*(a.radiusX||a.webkitRadiusX||0),c.height=2*(a.radiusY||a.webkitRadiusY||0),c.pressure=a.force||a.webkitForce||.5,c.isPrimary=this.isPrimaryTouch(a),c.pointerType=this.POINTER_TYPE,
c.altKey=b.altKey,c.ctrlKey=b.ctrlKey,c.metaKey=b.metaKey,c.shiftKey=b.shiftKey;
var e=this;return c.preventDefault=function(){e.scrolling=!1,e.firstXY=null,b.preventDefault()},c},processTouches:function(a,b){var c=a.changedTouches;this.currentTouchEvent=a;for(var d,e=0;e<c.length;e++)d=c[e],b.call(this,this.touchToPointer(d))},
shouldScroll:function(a){if(this.firstXY){var b,c=a.currentTarget._scrollType;if("none"===c)
b=!1;else if("XY"===c)
b=!0;else{var d=a.changedTouches[0],e=c,f="Y"===c?"X":"Y",g=Math.abs(d["client"+e]-this.firstXY[e]),h=Math.abs(d["client"+f]-this.firstXY[f]);
b=g>=h}return this.firstXY=null,b}},findTouch:function(a,b){for(var c,d=0,e=a.length;d<e&&(c=a[d]);d++)if(c.identifier===b)return!0},
vacuumTouches:function(a){var b=a.touches;
if(R.size>=b.length){var c=[];R.forEach(function(a,d){
if(1!==d&&!this.findTouch(b,d-2)){var e=a.out;c.push(e)}},this),c.forEach(this.cancelOut,this)}},touchstart:function(a){this.vacuumTouches(a),this.setPrimaryTouch(a.changedTouches[0]),this.dedupSynthMouse(a),this.scrolling||(this.clickCount++,this.processTouches(a,this.overDown))},overDown:function(a){R.set(a.pointerId,{target:a.target,out:a,outTarget:a.target}),u.enterOver(a),u.down(a)},touchmove:function(a){this.scrolling||(this.shouldScroll(a)?(this.scrolling=!0,this.touchcancel(a)):(a.preventDefault(),this.processTouches(a,this.moveOverOut)))},moveOverOut:function(a){var b=a,c=R.get(b.pointerId);
if(c){var d=c.out,e=c.outTarget;u.move(b),d&&e!==b.target&&(d.relatedTarget=b.target,b.relatedTarget=e,
d.target=e,b.target?(u.leaveOut(d),u.enterOver(b)):(
b.target=e,b.relatedTarget=null,this.cancelOut(b))),c.out=b,c.outTarget=b.target}},touchend:function(a){this.dedupSynthMouse(a),this.processTouches(a,this.upOut)},upOut:function(a){this.scrolling||(u.up(a),u.leaveOut(a)),this.cleanUpPointer(a)},touchcancel:function(a){this.processTouches(a,this.cancelOut)},cancelOut:function(a){u.cancel(a),u.leaveOut(a),this.cleanUpPointer(a)},cleanUpPointer:function(a){R["delete"](a.pointerId),this.removePrimaryPointer(a)},
dedupSynthMouse:function(a){var b=N.lastTouches,c=a.changedTouches[0];
if(this.isPrimaryTouch(c)){
var d={x:c.clientX,y:c.clientY};b.push(d);var e=function(a,b){var c=a.indexOf(b);c>-1&&a.splice(c,1)}.bind(null,b,d);setTimeout(e,S)}}};M=new c(V.elementAdded,V.elementRemoved,V.elementChanged,V);var W,X,Y,Z=u.pointermap,$=window.MSPointerEvent&&"number"==typeof window.MSPointerEvent.MSPOINTER_TYPE_MOUSE,_={events:["MSPointerDown","MSPointerMove","MSPointerUp","MSPointerOut","MSPointerOver","MSPointerCancel","MSGotPointerCapture","MSLostPointerCapture"],register:function(a){u.listen(a,this.events)},unregister:function(a){u.unlisten(a,this.events)},POINTER_TYPES:["","unavailable","touch","pen","mouse"],prepareEvent:function(a){var b=a;return $&&(b=u.cloneEvent(a),b.pointerType=this.POINTER_TYPES[a.pointerType]),b},cleanup:function(a){Z["delete"](a)},MSPointerDown:function(a){Z.set(a.pointerId,a);var b=this.prepareEvent(a);u.down(b)},MSPointerMove:function(a){var b=this.prepareEvent(a);u.move(b)},MSPointerUp:function(a){var b=this.prepareEvent(a);u.up(b),this.cleanup(a.pointerId)},MSPointerOut:function(a){var b=this.prepareEvent(a);u.leaveOut(b)},MSPointerOver:function(a){var b=this.prepareEvent(a);u.enterOver(b)},MSPointerCancel:function(a){var b=this.prepareEvent(a);u.cancel(b),this.cleanup(a.pointerId)},MSLostPointerCapture:function(a){var b=u.makeEvent("lostpointercapture",a);u.dispatchEvent(b)},MSGotPointerCapture:function(a){var b=u.makeEvent("gotpointercapture",a);u.dispatchEvent(b)}},aa=window.navigator;aa.msPointerEnabled?(W=function(a){i(a),j(this),k(a)&&(u.setCapture(a,this,!0),this.msSetPointerCapture(a))},X=function(a){i(a),u.releaseCapture(a,!0),this.msReleasePointerCapture(a)}):(W=function(a){i(a),j(this),k(a)&&u.setCapture(a,this)},X=function(a){i(a),u.releaseCapture(a)}),Y=function(a){return!!u.captureInfo[a]},g(),h(),l();var ba={dispatcher:u,Installer:c,PointerEvent:a,PointerMap:p,targetFinding:v};return ba});

///////////////////////////////////////////////

///////////////////////////////////////////////
var config = {"dark_mode": false, "show_pads": true, "show_fabrication": false, "show_silkscreen": true, "highlight_pin1": false, "redraw_on_drag": true, "board_rotation": 0, "checkboxes": "Sourced,Placed", "bom_view": "left-right", "layer_view": "FB", "fields": ["Value", "Footprint"]}
///////////////////////////////////////////////

///////////////////////////////////////////////
var pcbdata = JSON.parse(LZString.decompressFromBase64("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3Su1d0qegz3depzgi4GR1Lug51Keqb2puhpX522i302va3F2iYBhK1i3RK+200eBzxjWzy0TsygAQCLK2zs3K3YALblxch61QWru0B29c1kqhvgVWrVmdmya1yeZC3y22VWdStNknm8LVLW883Fajq30Mta09Wqp1x2x1VDWkABlmiu2XwY72iCj70kW7aWzWskTzWlq2A+tq0tm1a33M9a11uh+1PexO3+wBH3veyGmfer9ko+ua3Ga/72LW+xmHmla2dWsH2SekG2E+7MWdGEn2lSpH3Q2+xmo+7/jo+4H20+68D0+gX2Xm2RlM+wt0s+4a2KC4n1vezn1k+5H2Zq3n3sumn2laun1zmkX2Zcrq0v2iX1H21n35sl72pW2X2y0rn1qKpDVK+/n3tWwX1OgYX2W+0X1J08X2qeqT25svX3W0+H1G+8Gkm+3jW5c833U+5q0a+zH0Va0804+ih14+h526+qX2oOxKSve9VUe++X3c+68A++wrV++232tWwP0g+sX24+8H1Degn0R+iu0hwQ30x+1oA2BGq2m+vW2J+xs3J+mc1q+5a0a+4P3V2nX0lml32Ku3owc+431x+0v0zWqn1J+ha2q+oX3q+lP11+7X2O+za3hWqy0bey21be2K2DkxY6JWk6130lbi4laCDc2/WWfgOSWEW0qUBWx3VBWp5ki2x63OciK1m2obmF2yf0Y2+y0wcmf1l2nG0fARpD5IF2018oOU5gKLkbQKMxEcljkd20W0Pe9t2tAPoHKuhC3mev/nSclb2tuvRmQ+nC3gu7/3B+ULKmewf1jSwAPvu6b34+jd3zMlYl+eQ+WQ2//28auAOkeiT0N+rl1sq1mC9uNAMwujANX2rAPienj3M+9b2o2zb3o23slM2py2z+tm2nW+C012ry2XWqdnu20l3CW7f2cUv22f++93IUQ0osBmF2p2r70Z2hW1WKj906K0AOiuon1ZM3aL7OhS2eCmtWw2w22rek23I2yK102if20B183dsi/37e783Uck7lJhO/1u2kC0e27gOZK9/17+/gMgeofZ1FNoUiB/dkdaiQOdSqQOGimQPMe570mB+6SJuhT308mD3aqxjVIUjwO2KqgPaB4/26Bpi0Dk222MBg70GKuopjs2u0Ycny2+89f2y0zf2aShzl8BqK002rQPm26K1F2qf09svTmX+uf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"))
///////////////////////////////////////////////

///////////////////////////////////////////////
/* Utility functions */

var storagePrefix = 'KiCad_HTML_BOM__' + pcbdata.metadata.title + '__' +
  pcbdata.metadata.revision + '__#';
var storage;

function initStorage(key) {
  try {
    window.localStorage.getItem("blank");
    storage = window.localStorage;
  } catch (e) {
    // localStorage not available
  }
  if (!storage) {
    try {
      window.sessionStorage.getItem("blank");
      storage = window.sessionStorage;
    } catch (e) {
      // sessionStorage also not available
    }
  }
}

function readStorage(key) {
  if (storage) {
    return storage.getItem(storagePrefix + key);
  } else {
    return null;
  }
}

function writeStorage(key, value) {
  if (storage) {
    storage.setItem(storagePrefix + key, value);
  }
}

function fancyDblClickHandler(el, onsingle, ondouble) {
  return function() {
    if (el.getAttribute("data-dblclick") == null) {
      el.setAttribute("data-dblclick", 1);
      setTimeout(function() {
        if (el.getAttribute("data-dblclick") == 1) {
          onsingle();
        }
        el.removeAttribute("data-dblclick");
      }, 200);
    } else {
      el.removeAttribute("data-dblclick");
      ondouble();
    }
  }
}

function smoothScrollToRow(rowid) {
  document.getElementById(rowid).scrollIntoView({
    behavior: "smooth",
    block: "center",
    inline: "nearest"
  });
}

function focusInputField(input) {
  input.scrollIntoView(false);
  input.focus();
  input.select();
}

function copyToClipboard() {
  var text = '';
  for (var node of bomhead.childNodes[0].childNodes) {
    if (node.firstChild) {
      text = text + node.firstChild.nodeValue;
    }
    if (node != bomhead.childNodes[0].lastChild) {
      text += '\t';
    }
  }
  text += '\n';
  for (var row of bombody.childNodes) {
    for (var cell of row.childNodes) {
      for (var node of cell.childNodes) {
        if (node.nodeName == "INPUT") {
          if (node.checked) {
            text = text + '';
          }
        } else if (node.nodeName == "MARK") {
          text = text + node.firstChild.nodeValue;
        } else {
          text = text + node.nodeValue;
        }
      }
      if (cell != row.lastChild) {
        text += '\t';
      }
    }
    text += '\n';
  }
  var textArea = document.createElement("textarea");
  textArea.classList.add('clipboard-temp');
  textArea.value = text;

  document.body.appendChild(textArea);
  textArea.focus();
  textArea.select();

  try {
    if (document.execCommand('copy')) {
      console.log('Bom copied to clipboard.');
    }
  } catch (err) {
    console.log('Can not copy to clipboard.');
  }

  document.body.removeChild(textArea);
}

function removeGutterNode(node) {
  for (var i = 0; i < node.childNodes.length; i++) {
    if (node.childNodes[i].classList &&
      node.childNodes[i].classList.contains("gutter")) {
      node.removeChild(node.childNodes[i]);
      break;
    }
  }
}

function cleanGutters() {
  removeGutterNode(document.getElementById("bot"));
  removeGutterNode(document.getElementById("canvasdiv"));
}

var units = {
  prefixes: {
    giga: ["G", "g", "giga", "Giga", "GIGA"],
    mega: ["M", "mega", "Mega", "MEGA"],
    kilo: ["K", "k", "kilo", "Kilo", "KILO"],
    milli: ["m", "milli", "Milli", "MILLI"],
    micro: ["U", "u", "micro", "Micro", "MICRO", "", ""], // different utf8 
    nano: ["N", "n", "nano", "Nano", "NANO"],
    pico: ["P", "p", "pico", "Pico", "PICO"],
  },
  unitsShort: ["R", "r", "", "F", "f", "H", "h"],
  unitsLong: [
    "OHM", "Ohm", "ohm", "ohms",
    "FARAD", "Farad", "farad",
    "HENRY", "Henry", "henry"
  ],
  getMultiplier: function(s) {
    if (this.prefixes.giga.includes(s)) return 1e9;
    if (this.prefixes.mega.includes(s)) return 1e6;
    if (this.prefixes.kilo.includes(s)) return 1e3;
    if (this.prefixes.milli.includes(s)) return 1e-3;
    if (this.prefixes.micro.includes(s)) return 1e-6;
    if (this.prefixes.nano.includes(s)) return 1e-9;
    if (this.prefixes.pico.includes(s)) return 1e-12;
    return 1;
  },
  valueRegex: null,
}

function initUtils() {
  var allPrefixes = units.prefixes.giga
    .concat(units.prefixes.mega)
    .concat(units.prefixes.kilo)
    .concat(units.prefixes.milli)
    .concat(units.prefixes.micro)
    .concat(units.prefixes.nano)
    .concat(units.prefixes.pico);
  var allUnits = units.unitsShort.concat(units.unitsLong);
  units.valueRegex = new RegExp("^([0-9\.]+)" +
    "\\s*(" + allPrefixes.join("|") + ")?" +
    "(" + allUnits.join("|") + ")?" +
    "(\\b.*)?$", "");
  units.valueAltRegex = new RegExp("^([0-9]*)" +
    "(" + units.unitsShort.join("|") + ")?" +
    "([GgMmKkUuNnPp])?" +
    "([0-9]*)" +
    "(\\b.*)?$", "");
  if (config.fields.includes("Value")) {
    var index = config.fields.indexOf("Value");
    pcbdata.bom["parsedValues"] = {};
    for (var id in pcbdata.bom.fields) {
      pcbdata.bom.parsedValues[id] = parseValue(pcbdata.bom.fields[id][index])
    }
  }
}

function parseValue(val, ref) {
  var inferUnit = (unit, ref) => {
    if (unit) {
      unit = unit.toLowerCase();
      if (unit == '' || unit == "ohm" || unit == "ohms") {
        unit = 'r';
      }
      unit = unit[0];
    } else {
      ref = /^([a-z]+)\d+$/i.exec(ref);
      if (ref) {
        ref = ref[1].toLowerCase();
        if (ref == "c") unit = 'f';
        else if (ref == "l") unit = 'h';
        else if (ref == "r" || ref == "rv") unit = 'r';
        else unit = null;
      }
    }
    return unit;
  };
  val = val.replace(/,/g, "");
  var match = units.valueRegex.exec(val);
  var unit;
  if (match) {
    val = parseFloat(match[1]);
    if (match[2]) {
      val = val * units.getMultiplier(match[2]);
    }
    unit = inferUnit(match[3], ref);
    if (!unit) return null;
    else return {
      val: val,
      unit: unit,
      extra: match[4],
    }
  }
  match = units.valueAltRegex.exec(val);
  if (match && (match[1] || match[4])) {
    val = parseFloat(match[1] + "." + match[4]);
    if (match[3]) {
      val = val * units.getMultiplier(match[3]);
    }
    unit = inferUnit(match[2], ref);
    if (!unit) return null;
    else return {
      val: val,
      unit: unit,
      extra: match[5],
    }
  }
  return null;
}

function valueCompare(a, b, stra, strb) {
  if (a === null && b === null) {
    // Failed to parse both values, compare them as strings.
    if (stra != strb) return stra > strb ? 1 : -1;
    else return 0;
  } else if (a === null) {
    return 1;
  } else if (b === null) {
    return -1;
  } else {
    if (a.unit != b.unit) return a.unit > b.unit ? 1 : -1;
    else if (a.val != b.val) return a.val > b.val ? 1 : -1;
    else if (a.extra != b.extra) return a.extra > b.extra ? 1 : -1;
    else return 0;
  }
}

function validateSaveImgDimension(element) {
  var valid = false;
  var intValue = 0;
  if (/^[1-9]\d*$/.test(element.value)) {
    intValue = parseInt(element.value);
    if (intValue <= 16000) {
      valid = true;
    }
  }
  if (valid) {
    element.classList.remove("invalid");
  } else {
    element.classList.add("invalid");
  }
  return intValue;
}

function saveImage(layer) {
  var width = validateSaveImgDimension(document.getElementById("render-save-width"));
  var height = validateSaveImgDimension(document.getElementById("render-save-height"));
  var bgcolor = null;
  if (!document.getElementById("render-save-transparent").checked) {
    var style = getComputedStyle(topmostdiv);
    bgcolor = style.getPropertyValue("background-color");
  }
  if (!width || !height) return;

  // Prepare image
  var canvas = document.createElement("canvas");
  var layerdict = {
    transform: {
      x: 0,
      y: 0,
      s: 1,
      panx: 0,
      pany: 0,
      zoom: 1,
    },
    bg: canvas,
    fab: canvas,
    silk: canvas,
    highlight: canvas,
    layer: layer,
  }
  // Do the rendering
  recalcLayerScale(layerdict, width, height);
  prepareLayer(layerdict);
  clearCanvas(canvas, bgcolor);
  drawBackground(layerdict, false);
  drawHighlightsOnLayer(layerdict, false);

  // Save image
  var imgdata = canvas.toDataURL("image/png");

  var filename = pcbdata.metadata.title;
  if (pcbdata.metadata.revision) {
    filename += `.${pcbdata.metadata.revision}`;
  }
  filename += `.${layer}.png`;
  saveFile(filename, dataURLtoBlob(imgdata));
}

function saveSettings() {
  var data = {
    type: "InteractiveHtmlBom settings",
    version: 1,
    pcbmetadata: pcbdata.metadata,
    settings: settings,
  }
  var blob = new Blob([JSON.stringify(data, null, 4)], {
    type: "application/json"
  });
  saveFile(`${pcbdata.metadata.title}.settings.json`, blob);
}

function loadSettings() {
  var input = document.createElement("input");
  input.type = "file";
  input.accept = ".settings.json";
  input.onchange = function(e) {
    var file = e.target.files[0];
    var reader = new FileReader();
    reader.onload = readerEvent => {
      var content = readerEvent.target.result;
      var newSettings;
      try {
        newSettings = JSON.parse(content);
      } catch (e) {
        alert("Selected file is not InteractiveHtmlBom settings file.");
        return;
      }
      if (newSettings.type != "InteractiveHtmlBom settings") {
        alert("Selected file is not InteractiveHtmlBom settings file.");
        return;
      }
      var metadataMatches = newSettings.hasOwnProperty("pcbmetadata");
      if (metadataMatches) {
        for (var k in pcbdata.metadata) {
          if (!newSettings.pcbmetadata.hasOwnProperty(k) || newSettings.pcbmetadata[k] != pcbdata.metadata[k]) {
            metadataMatches = false;
          }
        }
      }
      if (!metadataMatches) {
        var currentMetadata = JSON.stringify(pcbdata.metadata, null, 4);
        var fileMetadata = JSON.stringify(newSettings.pcbmetadata, null, 4);
        if (!confirm(
            `Settins file metadata does not match current metadata.\n\n` +
            `Page metadata:\n${currentMetadata}\n\n` +
            `Settings file metadata:\n${fileMetadata}\n\n` +
            `Press OK if you would like to import settings anyway.`)) {
          return;
        }
      }
      overwriteSettings(newSettings.settings);
    }
    reader.readAsText(file, 'UTF-8');
  }
  input.click();
}

function overwriteSettings(newSettings) {
  initDone = false;
  Object.assign(settings, newSettings);
  writeStorage("bomlayout", settings.bomlayout);
  writeStorage("bommode", settings.bommode);
  writeStorage("canvaslayout", settings.canvaslayout);
  writeStorage("bomCheckboxes", settings.checkboxes.join(","));
  document.getElementById("bomCheckboxes").value = settings.checkboxes.join(",");
  for (var checkbox of settings.checkboxes) {
    writeStorage("checkbox_" + checkbox, settings.checkboxStoredRefs[checkbox]);
  }
  writeStorage("markWhenChecked", settings.markWhenChecked);
  padsVisible(settings.renderPads);
  document.getElementById("padsCheckbox").checked = settings.renderPads;
  fabricationVisible(settings.renderFabrication);
  document.getElementById("fabricationCheckbox").checked = settings.renderFabrication;
  silkscreenVisible(settings.renderSilkscreen);
  document.getElementById("silkscreenCheckbox").checked = settings.renderSilkscreen;
  referencesVisible(settings.renderReferences);
  document.getElementById("referencesCheckbox").checked = settings.renderReferences;
  valuesVisible(settings.renderValues);
  document.getElementById("valuesCheckbox").checked = settings.renderValues;
  tracksVisible(settings.renderTracks);
  document.getElementById("tracksCheckbox").checked = settings.renderTracks;
  zonesVisible(settings.renderZones);
  document.getElementById("zonesCheckbox").checked = settings.renderZones;
  dnpOutline(settings.renderDnpOutline);
  document.getElementById("dnpOutlineCheckbox").checked = settings.renderDnpOutline;
  setRedrawOnDrag(settings.redrawOnDrag);
  document.getElementById("dragCheckbox").checked = settings.redrawOnDrag;
  setDarkMode(settings.darkMode);
  document.getElementById("darkmodeCheckbox").checked = settings.darkMode;
  setHighlightPin1(settings.highlightpin1);
  document.getElementById("highlightpin1Checkbox").checked = settings.highlightpin1;
  showFootprints(settings.show_footprints);
  writeStorage("boardRotation", settings.boardRotation);
  document.getElementById("boardRotation").value = settings.boardRotation / 5;
  document.getElementById("rotationDegree").textContent = settings.boardRotation;
  initDone = true;
  prepCheckboxes();
  changeBomLayout(settings.bomlayout);
}

function saveFile(filename, blob) {
  var link = document.createElement("a");
  var objurl = URL.createObjectURL(blob);
  link.download = filename;
  link.href = objurl;
  link.click();
}

function dataURLtoBlob(dataurl) {
  var arr = dataurl.split(','),
    mime = arr[0].match(/:(.*?);/)[1],
    bstr = atob(arr[1]),
    n = bstr.length,
    u8arr = new Uint8Array(n);
  while (n--) {
    u8arr[n] = bstr.charCodeAt(n);
  }
  return new Blob([u8arr], {
    type: mime
  });
}

var settings = {
  canvaslayout: "default",
  bomlayout: "default",
  bommode: "grouped",
  checkboxes: [],
  checkboxStoredRefs: {},
  darkMode: false,
  highlightpin1: false,
  redrawOnDrag: true,
  boardRotation: 0,
  renderPads: true,
  renderReferences: true,
  renderValues: true,
  renderSilkscreen: true,
  renderFabrication: true,
  renderDnpOutline: false,
  renderTracks: true,
  renderZones: true,
  columnOrder: [],
  hiddenColumns: [],
}

function initDefaults() {
  settings.bomlayout = readStorage("bomlayout");
  if (settings.bomlayout === null) {
    settings.bomlayout = config.bom_view;
  }
  if (!['bom-only', 'left-right', 'top-bottom'].includes(settings.bomlayout)) {
    settings.bomlayout = config.bom_view;
  }
  settings.bommode = readStorage("bommode");
  if (settings.bommode === null) {
    settings.bommode = "grouped";
  }
  if (!["grouped", "ungrouped", "netlist"].includes(settings.bommode)) {
    settings.bommode = "grouped";
  }
  settings.canvaslayout = readStorage("canvaslayout");
  if (settings.canvaslayout === null) {
    settings.canvaslayout = config.layer_view;
  }
  var bomCheckboxes = readStorage("bomCheckboxes");
  if (bomCheckboxes === null) {
    bomCheckboxes = config.checkboxes;
  }
  settings.checkboxes = bomCheckboxes.split(",").filter((e) => e);
  document.getElementById("bomCheckboxes").value = bomCheckboxes;

  settings.markWhenChecked = readStorage("markWhenChecked") || "";
  populateMarkWhenCheckedOptions();

  function initBooleanSetting(storageString, def, elementId, func) {
    var b = readStorage(storageString);
    if (b === null) {
      b = def;
    } else {
      b = (b == "true");
    }
    document.getElementById(elementId).checked = b;
    func(b);
  }

  initBooleanSetting("padsVisible", config.show_pads, "padsCheckbox", padsVisible);
  initBooleanSetting("fabricationVisible", config.show_fabrication, "fabricationCheckbox", fabricationVisible);
  initBooleanSetting("silkscreenVisible", config.show_silkscreen, "silkscreenCheckbox", silkscreenVisible);
  initBooleanSetting("referencesVisible", true, "referencesCheckbox", referencesVisible);
  initBooleanSetting("valuesVisible", true, "valuesCheckbox", valuesVisible);
  if ("tracks" in pcbdata) {
    initBooleanSetting("tracksVisible", true, "tracksCheckbox", tracksVisible);
    initBooleanSetting("zonesVisible", true, "zonesCheckbox", zonesVisible);
  } else {
    document.getElementById("tracksAndZonesCheckboxes").style.display = "none";
    tracksVisible(false);
    zonesVisible(false);
  }
  initBooleanSetting("dnpOutline", false, "dnpOutlineCheckbox", dnpOutline);
  initBooleanSetting("redrawOnDrag", config.redraw_on_drag, "dragCheckbox", setRedrawOnDrag);
  initBooleanSetting("darkmode", config.dark_mode, "darkmodeCheckbox", setDarkMode);
  initBooleanSetting("highlightpin1", config.highlight_pin1, "highlightpin1Checkbox", setHighlightPin1);

  var fields = ["checkboxes", "References"].concat(config.fields).concat(["Quantity"]);
  var hcols = JSON.parse(readStorage("hiddenColumns"));
  if (hcols === null) {
    hcols = [];
  }
  settings.hiddenColumns = hcols.filter(e => fields.includes(e));

  var cord = JSON.parse(readStorage("columnOrder"));
  if (cord === null) {
    cord = fields;
  } else {
    cord = cord.filter(e => fields.includes(e));
    if (cord.length != fields.length)
      cord = fields;
  }
  settings.columnOrder = cord;

  settings.boardRotation = readStorage("boardRotation");
  if (settings.boardRotation === null) {
    settings.boardRotation = config.board_rotation * 5;
  } else {
    settings.boardRotation = parseInt(settings.boardRotation);
  }
  document.getElementById("boardRotation").value = settings.boardRotation / 5;
  document.getElementById("rotationDegree").textContent = settings.boardRotation;
}

// Helper classes for user js callbacks.

const IBOM_EVENT_TYPES = {
  ALL: "all",
  HIGHLIGHT_EVENT: "highlightEvent",
  CHECKBOX_CHANGE_EVENT: "checkboxChangeEvent",
  BOM_BODY_CHANGE_EVENT: "bomBodyChangeEvent",
}

const EventHandler = {
  callbacks: {},
  init: function() {
    for (eventType of Object.values(IBOM_EVENT_TYPES))
      this.callbacks[eventType] = [];
  },
  registerCallback: function(eventType, callback) {
    this.callbacks[eventType].push(callback);
  },
  emitEvent: function(eventType, eventArgs) {
    event = {
      eventType: eventType,
      args: eventArgs,
    }
    var callback;
    for (callback of this.callbacks[eventType])
      callback(event);
    for (callback of this.callbacks[IBOM_EVENT_TYPES.ALL])
      callback(event);
  }
}
EventHandler.init();

///////////////////////////////////////////////

///////////////////////////////////////////////
/* PCB rendering code */

var emptyContext2d = document.createElement("canvas").getContext("2d");

function deg2rad(deg) {
  return deg * Math.PI / 180;
}

function calcFontPoint(linepoint, text, offsetx, offsety, tilt) {
  var point = [
    linepoint[0] * text.width + offsetx,
    linepoint[1] * text.height + offsety
  ];
  // This approximates pcbnew behavior with how text tilts depending on horizontal justification
  point[0] -= (linepoint[1] + 0.5 * (1 + text.justify[0])) * text.height * tilt;
  return point;
}

function drawText(ctx, text, color) {
  if ("ref" in text && !settings.renderReferences) return;
  if ("val" in text && !settings.renderValues) return;
  ctx.save();
  ctx.fillStyle = color;
  ctx.strokeStyle = color;
  ctx.lineCap = "round";
  ctx.lineJoin = "round";
  ctx.lineWidth = text.thickness;
  if ("svgpath" in text) {
    ctx.stroke(new Path2D(text.svgpath));
    ctx.restore();
    return;
  }
  ctx.translate(...text.pos);
  ctx.translate(text.thickness * 0.5, 0);
  var angle = -text.angle;
  if (text.attr.includes("mirrored")) {
    ctx.scale(-1, 1);
    angle = -angle;
  }
  var tilt = 0;
  if (text.attr.includes("italic")) {
    tilt = 0.125;
  }
  var interline = text.height * 1.5 + text.thickness;
  var txt = text.text.split("\n");
  // KiCad ignores last empty line.
  if (txt[txt.length - 1] == '') txt.pop();
  ctx.rotate(deg2rad(angle));
  var offsety = (1 - text.justify[1]) / 2 * text.height; // One line offset
  offsety -= (txt.length - 1) * (text.justify[1] + 1) / 2 * interline; // Multiline offset
  for (var i in txt) {
    var lineWidth = text.thickness + interline / 2 * tilt;
    for (var j = 0; j < txt[i].length; j++) {
      if (txt[i][j] == '\t') {
        var fourSpaces = 4 * pcbdata.font_data[' '].w * text.width;
        lineWidth += fourSpaces - lineWidth % fourSpaces;
      } else {
        if (txt[i][j] == '~') {
          j++;
          if (j == txt[i].length)
            break;
        }
        lineWidth += pcbdata.font_data[txt[i][j]].w * text.width;
      }
    }
    var offsetx = -lineWidth * (text.justify[0] + 1) / 2;
    var inOverbar = false;
    for (var j = 0; j < txt[i].length; j++) {
      if (txt[i][j] == '\t') {
        var fourSpaces = 4 * pcbdata.font_data[' '].w * text.width;
        offsetx += fourSpaces - offsetx % fourSpaces;
        continue;
      } else if (txt[i][j] == '~') {
        j++;
        if (j == txt[i].length)
          break;
        if (txt[i][j] != '~') {
          inOverbar = !inOverbar;
        }
      }
      var glyph = pcbdata.font_data[txt[i][j]];
      if (inOverbar) {
        var overbarStart = [offsetx, -text.height * 1.4 + offsety];
        var overbarEnd = [offsetx + text.width * glyph.w, overbarStart[1]];

        if (!lastHadOverbar) {
          overbarStart[0] += text.height * 1.4 * tilt;
          lastHadOverbar = true;
        }
        ctx.beginPath();
        ctx.moveTo(...overbarStart);
        ctx.lineTo(...overbarEnd);
        ctx.stroke();
      } else {
        lastHadOverbar = false;
      }
      for (var line of glyph.l) {
        ctx.beginPath();
        ctx.moveTo(...calcFontPoint(line[0], text, offsetx, offsety, tilt));
        for (var k = 1; k < line.length; k++) {
          ctx.lineTo(...calcFontPoint(line[k], text, offsetx, offsety, tilt));
        }
        ctx.stroke();
      }
      offsetx += glyph.w * text.width;
    }
    offsety += interline;
  }
  ctx.restore();
}

function drawedge(ctx, scalefactor, edge, color) {
  ctx.strokeStyle = color;
  ctx.fillStyle = color;
  ctx.lineWidth = Math.max(1 / scalefactor, edge.width);
  ctx.lineCap = "round";
  ctx.lineJoin = "round";
  if ("svgpath" in edge) {
    ctx.stroke(new Path2D(edge.svgpath));
  } else {
    ctx.beginPath();
    if (edge.type == "segment") {
      ctx.moveTo(...edge.start);
      ctx.lineTo(...edge.end);
    }
    if (edge.type == "rect") {
      ctx.moveTo(...edge.start);
      ctx.lineTo(edge.start[0], edge.end[1]);
      ctx.lineTo(...edge.end);
      ctx.lineTo(edge.end[0], edge.start[1]);
      ctx.lineTo(...edge.start);
    }
    if (edge.type == "arc") {
      ctx.arc(
        ...edge.start,
        edge.radius,
        deg2rad(edge.startangle),
        deg2rad(edge.endangle));
    }
    if (edge.type == "circle") {
      ctx.arc(
        ...edge.start,
        edge.radius,
        0, 2 * Math.PI);
      ctx.closePath();
    }
    if (edge.type == "curve") {
      ctx.moveTo(...edge.start);
      ctx.bezierCurveTo(...edge.cpa, ...edge.cpb, ...edge.end);
    }
    if("filled" in edge && edge.filled)
      ctx.fill();
    else
      ctx.stroke();
  }
}

function getChamferedRectPath(size, radius, chamfpos, chamfratio) {
  // chamfpos is a bitmask, left = 1, right = 2, bottom left = 4, bottom right = 8
  var path = new Path2D();
  var width = size[0];
  var height = size[1];
  var x = width * -0.5;
  var y = height * -0.5;
  var chamfOffset = Math.min(width, height) * chamfratio;
  path.moveTo(x, 0);
  if (chamfpos & 4) {
    path.lineTo(x, y + height - chamfOffset);
    path.lineTo(x + chamfOffset, y + height);
    path.lineTo(0, y + height);
  } else {
    path.arcTo(x, y + height, x + width, y + height, radius);
  }
  if (chamfpos & 8) {
    path.lineTo(x + width - chamfOffset, y + height);
    path.lineTo(x + width, y + height - chamfOffset);
    path.lineTo(x + width, 0);
  } else {
    path.arcTo(x + width, y + height, x + width, y, radius);
  }
  if (chamfpos & 2) {
    path.lineTo(x + width, y + chamfOffset);
    path.lineTo(x + width - chamfOffset, y);
    path.lineTo(0, y);
  } else {
    path.arcTo(x + width, y, x, y, radius);
  }
  if (chamfpos & 1) {
    path.lineTo(x + chamfOffset, y);
    path.lineTo(x, y + chamfOffset);
    path.lineTo(x, 0);
  } else {
    path.arcTo(x, y, x, y + height, radius);
  }
  path.closePath();
  return path;
}

function getOblongPath(size) {
  return getChamferedRectPath(size, Math.min(size[0], size[1]) / 2, 0, 0);
}

function getPolygonsPath(shape) {
  if (shape.path2d) {
    return shape.path2d;
  }
  if ("svgpath" in shape) {
    shape.path2d = new Path2D(shape.svgpath);
  } else {
    var path = new Path2D();
    for (var polygon of shape.polygons) {
      path.moveTo(...polygon[0]);
      for (var i = 1; i < polygon.length; i++) {
        path.lineTo(...polygon[i]);
      }
      path.closePath();
    }
    shape.path2d = path;
  }
  return shape.path2d;
}

function drawPolygonShape(ctx, scalefactor, shape, color) {
  ctx.save();
  if (!("svgpath" in shape)) {
    ctx.translate(...shape.pos);
    ctx.rotate(deg2rad(-shape.angle));
  }
  if("filled" in shape && !shape.filled) {
    ctx.strokeStyle = color;
    ctx.lineWidth = Math.max(1 / scalefactor, shape.width);
    ctx.lineCap = "round";
    ctx.lineJoin = "round";
    ctx.stroke(getPolygonsPath(shape));
  } else {
    ctx.fillStyle = color;
    ctx.fill(getPolygonsPath(shape));
  }
  ctx.restore();
}

function drawDrawing(ctx, scalefactor, drawing, color) {
  if (["segment", "arc", "circle", "curve", "rect"].includes(drawing.type)) {
    drawedge(ctx, scalefactor, drawing, color);
  } else if (drawing.type == "polygon") {
    drawPolygonShape(ctx, scalefactor, drawing, color);
  } else {
    drawText(ctx, drawing, color);
  }
}

function getCirclePath(radius) {
  var path = new Path2D();
  path.arc(0, 0, radius, 0, 2 * Math.PI);
  path.closePath();
  return path;
}

function getCachedPadPath(pad) {
  if (!pad.path2d) {
    // if path2d is not set, build one and cache it on pad object
    if (pad.shape == "rect") {
      pad.path2d = new Path2D();
      pad.path2d.rect(...pad.size.map(c => -c * 0.5), ...pad.size);
    } else if (pad.shape == "oval") {
      pad.path2d = getOblongPath(pad.size);
    } else if (pad.shape == "circle") {
      pad.path2d = getCirclePath(pad.size[0] / 2);
    } else if (pad.shape == "roundrect") {
      pad.path2d = getChamferedRectPath(pad.size, pad.radius, 0, 0);
    } else if (pad.shape == "chamfrect") {
      pad.path2d = getChamferedRectPath(pad.size, pad.radius, pad.chamfpos, pad.chamfratio)
    } else if (pad.shape == "custom") {
      pad.path2d = getPolygonsPath(pad);
    }
  }
  return pad.path2d;
}

function drawPad(ctx, pad, color, outline) {
  ctx.save();
  ctx.translate(...pad.pos);
  ctx.rotate(deg2rad(pad.angle));
  if (pad.offset) {
    ctx.translate(...pad.offset);
  }
  ctx.fillStyle = color;
  ctx.strokeStyle = color;
  var path = getCachedPadPath(pad);
  if (outline) {
    ctx.stroke(path);
  } else {
    ctx.fill(path);
  }
  ctx.restore();
}

function drawPadHole(ctx, pad, padHoleColor) {
  if (pad.type != "th") return;
  ctx.save();
  ctx.translate(...pad.pos);
  ctx.rotate(deg2rad(pad.angle));
  ctx.fillStyle = padHoleColor;
  if (pad.drillshape == "oblong") {
    ctx.fill(getOblongPath(pad.drillsize));
  } else {
    ctx.fill(getCirclePath(pad.drillsize[0] / 2));
  }
  ctx.restore();
}

function drawFootprint(ctx, layer, scalefactor, footprint, colors, highlight, outline) {
  if (highlight) {
    // draw bounding box
    if (footprint.layer == layer) {
      ctx.save();
      ctx.globalAlpha = 0.2;
      ctx.translate(...footprint.bbox.pos);
      ctx.rotate(deg2rad(-footprint.bbox.angle));
      ctx.translate(...footprint.bbox.relpos);
      ctx.fillStyle = colors.pad;
      ctx.fillRect(0, 0, ...footprint.bbox.size);
      ctx.globalAlpha = 1;
      ctx.strokeStyle = colors.pad;
      ctx.strokeRect(0, 0, ...footprint.bbox.size);
      ctx.restore();
    }
  }
  // draw drawings
  for (var drawing of footprint.drawings) {
    if (drawing.layer == layer) {
      drawDrawing(ctx, scalefactor, drawing.drawing, colors.pad);
    }
  }
  // draw pads
  if (settings.renderPads) {
    for (var pad of footprint.pads) {
      if (pad.layers.includes(layer)) {
        drawPad(ctx, pad, colors.pad, outline);
        if (pad.pin1 && settings.highlightpin1) {
          drawPad(ctx, pad, colors.outline, true);
        }
      }
    }
    for (var pad of footprint.pads) {
      drawPadHole(ctx, pad, colors.padHole);
    }
  }
}

function drawEdgeCuts(canvas, scalefactor) {
  var ctx = canvas.getContext("2d");
  var edgecolor = getComputedStyle(topmostdiv).getPropertyValue('--pcb-edge-color');
  for (var edge of pcbdata.edges) {
    drawDrawing(ctx, scalefactor, edge, edgecolor);
  }
}

function drawFootprints(canvas, layer, scalefactor, highlight) {
  var ctx = canvas.getContext("2d");
  ctx.lineWidth = 3 / scalefactor;
  var style = getComputedStyle(topmostdiv);

  var colors = {
    pad: style.getPropertyValue('--pad-color'),
    padHole: style.getPropertyValue('--pad-hole-color'),
    outline: style.getPropertyValue('--pin1-outline-color'),
  }

  for (var i = 0; i < pcbdata.footprints.length; i++) {
    var mod = pcbdata.footprints[i];
    var outline = settings.renderDnpOutline && pcbdata.bom.skipped.includes(i);
    var h = highlightedFootprints.includes(i);
    var d = markedFootprints.has(i);
    if (highlight) {
      if(h && d) {
        colors.pad = style.getPropertyValue('--pad-color-highlight-both');
        colors.outline = style.getPropertyValue('--pin1-outline-color-highlight-both');
      } else if (h) {
        colors.pad = style.getPropertyValue('--pad-color-highlight');
        colors.outline = style.getPropertyValue('--pin1-outline-color-highlight');
      } else if (d) {
        colors.pad = style.getPropertyValue('--pad-color-highlight-marked');
        colors.outline = style.getPropertyValue('--pin1-outline-color-highlight-marked');
      }
    }
    if( h || d || !highlight) {
      drawFootprint(ctx, layer, scalefactor, mod, colors, highlight, outline);
    }
  }
}

function drawBgLayer(layername, canvas, layer, scalefactor, edgeColor, polygonColor, textColor) {
  var ctx = canvas.getContext("2d");
  for (var d of pcbdata.drawings[layername][layer]) {
    if (["segment", "arc", "circle", "curve", "rect"].includes(d.type)) {
      drawedge(ctx, scalefactor, d, edgeColor);
    } else if (d.type == "polygon") {
      drawPolygonShape(ctx, scalefactor, d, polygonColor);
    } else {
      drawText(ctx, d, textColor);
    }
  }
}

function drawTracks(canvas, layer, color, highlight) {
  ctx = canvas.getContext("2d");
  ctx.strokeStyle = color;
  ctx.lineCap = "round";
  for (var track of pcbdata.tracks[layer]) {
    if (highlight && highlightedNet != track.net) continue;
    ctx.lineWidth = track.width;
    ctx.beginPath();
    if ('radius' in track) {
      ctx.arc(
        ...track.center,
        track.radius,
        deg2rad(track.startangle),
        deg2rad(track.endangle));
    } else {
      ctx.moveTo(...track.start);
      ctx.lineTo(...track.end);
    }
    ctx.stroke();
  }
}

function drawZones(canvas, layer, color, highlight) {
  ctx = canvas.getContext("2d");
  ctx.strokeStyle = color;
  ctx.fillStyle = color;
  ctx.lineJoin = "round";
  for (var zone of pcbdata.zones[layer]) {
    if (!zone.path2d) {
      zone.path2d = getPolygonsPath(zone);
    }
    if (highlight && highlightedNet != zone.net) continue;
    ctx.fill(zone.path2d);
    if (zone.width > 0) {
      ctx.lineWidth = zone.width;
      ctx.stroke(zone.path2d);
    }
  }
}

function clearCanvas(canvas, color = null) {
  var ctx = canvas.getContext("2d");
  ctx.save();
  ctx.setTransform(1, 0, 0, 1, 0, 0);
  if (color) {
    ctx.fillStyle = color;
    ctx.fillRect(0, 0, canvas.width, canvas.height);
  } else {
    if (!window.matchMedia("print").matches)
      ctx.clearRect(0, 0, canvas.width, canvas.height);
  }
  ctx.restore();
}

function drawNets(canvas, layer, highlight) {
  var style = getComputedStyle(topmostdiv);
  if (settings.renderTracks) {
    var trackColor = style.getPropertyValue(highlight ? '--track-color-highlight' : '--track-color');
    drawTracks(canvas, layer, trackColor, highlight);
  }
  if (settings.renderZones) {
    var zoneColor = style.getPropertyValue(highlight ? '--zone-color-highlight' : '--zone-color');
    drawZones(canvas, layer, zoneColor, highlight);
  }
  if (highlight && settings.renderPads) {
    var padColor = style.getPropertyValue('--pad-color-highlight');
    var padHoleColor = style.getPropertyValue('--pad-hole-color');
    var ctx = canvas.getContext("2d");
    for (var footprint of pcbdata.footprints) {
      // draw pads
      var padDrawn = false;
      for (var pad of footprint.pads) {
        if (highlightedNet != pad.net) continue;
        if (pad.layers.includes(layer)) {
          drawPad(ctx, pad, padColor, false);
          padDrawn = true;
        }
      }
      if (padDrawn) {
        // redraw all pad holes because some pads may overlap
        for (var pad of footprint.pads) {
          drawPadHole(ctx, pad, padHoleColor);
        }
      }
    }
  }
}

function drawHighlightsOnLayer(canvasdict, clear = true) {
  if (clear) {
    clearCanvas(canvasdict.highlight);
  }
  if (markedFootprints.size > 0 || highlightedFootprints.length > 0) {
    drawFootprints(canvasdict.highlight, canvasdict.layer,
      canvasdict.transform.s * canvasdict.transform.zoom, true);
  }
  if (highlightedNet !== null) {
    drawNets(canvasdict.highlight, canvasdict.layer, true);
  }
}

function drawHighlights() {
  drawHighlightsOnLayer(allcanvas.front);
  drawHighlightsOnLayer(allcanvas.back);
}

function drawBackground(canvasdict, clear = true) {
  if (clear) {
    clearCanvas(canvasdict.bg);
    clearCanvas(canvasdict.fab);
    clearCanvas(canvasdict.silk);
  }

  drawNets(canvasdict.bg, canvasdict.layer, false);
  drawFootprints(canvasdict.bg, canvasdict.layer,
    canvasdict.transform.s * canvasdict.transform.zoom, false);

  drawEdgeCuts(canvasdict.bg, canvasdict.transform.s * canvasdict.transform.zoom);

  var style = getComputedStyle(topmostdiv);
  var edgeColor = style.getPropertyValue('--silkscreen-edge-color');
  var polygonColor = style.getPropertyValue('--silkscreen-polygon-color');
  var textColor = style.getPropertyValue('--silkscreen-text-color');
  if (settings.renderSilkscreen) {
    drawBgLayer(
      "silkscreen", canvasdict.silk, canvasdict.layer,
      canvasdict.transform.s * canvasdict.transform.zoom,
      edgeColor, polygonColor, textColor);
  }
  edgeColor = style.getPropertyValue('--fabrication-edge-color');
  polygonColor = style.getPropertyValue('--fabrication-polygon-color');
  textColor = style.getPropertyValue('--fabrication-text-color');
  if (settings.renderFabrication) {
    drawBgLayer(
      "fabrication", canvasdict.fab, canvasdict.layer,
      canvasdict.transform.s * canvasdict.transform.zoom,
      edgeColor, polygonColor, textColor);
  }
}

function prepareCanvas(canvas, flip, transform) {
  var ctx = canvas.getContext("2d");
  ctx.setTransform(1, 0, 0, 1, 0, 0);
  var fontsize = 1.55;
  ctx.scale(transform.zoom, transform.zoom);
  ctx.translate(transform.panx, transform.pany);
  if (flip) {
    ctx.scale(-1, 1);
  }
  ctx.translate(transform.x, transform.y);
  ctx.rotate(deg2rad(settings.boardRotation));
  ctx.scale(transform.s, transform.s);
}

function prepareLayer(canvasdict) {
  var flip = (canvasdict.layer == "B");
  for (var c of ["bg", "fab", "silk", "highlight"]) {
    prepareCanvas(canvasdict[c], flip, canvasdict.transform);
  }
}

function rotateVector(v, angle) {
  angle = deg2rad(angle);
  return [
    v[0] * Math.cos(angle) - v[1] * Math.sin(angle),
    v[0] * Math.sin(angle) + v[1] * Math.cos(angle)
  ];
}

function applyRotation(bbox) {
  var corners = [
    [bbox.minx, bbox.miny],
    [bbox.minx, bbox.maxy],
    [bbox.maxx, bbox.miny],
    [bbox.maxx, bbox.maxy],
  ];
  corners = corners.map((v) => rotateVector(v, settings.boardRotation));
  return {
    minx: corners.reduce((a, v) => Math.min(a, v[0]), Infinity),
    miny: corners.reduce((a, v) => Math.min(a, v[1]), Infinity),
    maxx: corners.reduce((a, v) => Math.max(a, v[0]), -Infinity),
    maxy: corners.reduce((a, v) => Math.max(a, v[1]), -Infinity),
  }
}

function recalcLayerScale(layerdict, width, height) {
  var bbox = applyRotation(pcbdata.edges_bbox);
  var scalefactor = 0.98 * Math.min(
    width / (bbox.maxx - bbox.minx),
    height / (bbox.maxy - bbox.miny)
  );
  if (scalefactor < 0.1) {
    scalefactor = 1;
  }
  layerdict.transform.s = scalefactor;
  var flip = (layerdict.layer == "B");
  if (flip) {
    layerdict.transform.x = -((bbox.maxx + bbox.minx) * scalefactor + width) * 0.5;
  } else {
    layerdict.transform.x = -((bbox.maxx + bbox.minx) * scalefactor - width) * 0.5;
  }
  layerdict.transform.y = -((bbox.maxy + bbox.miny) * scalefactor - height) * 0.5;
  for (var c of ["bg", "fab", "silk", "highlight"]) {
    canvas = layerdict[c];
    canvas.width = width;
    canvas.height = height;
    canvas.style.width = (width / devicePixelRatio) + "px";
    canvas.style.height = (height / devicePixelRatio) + "px";
  }
}

function redrawCanvas(layerdict) {
  prepareLayer(layerdict);
  drawBackground(layerdict);
  drawHighlightsOnLayer(layerdict);
}

function resizeCanvas(layerdict) {
  var canvasdivid = {
    "F": "frontcanvas",
    "B": "backcanvas"
  } [layerdict.layer];
  var width = document.getElementById(canvasdivid).clientWidth * devicePixelRatio;
  var height = document.getElementById(canvasdivid).clientHeight * devicePixelRatio;
  recalcLayerScale(layerdict, width, height);
  redrawCanvas(layerdict);
}

function resizeAll() {
  resizeCanvas(allcanvas.front);
  resizeCanvas(allcanvas.back);
}

function pointWithinDistanceToSegment(x, y, x1, y1, x2, y2, d) {
  var A = x - x1;
  var B = y - y1;
  var C = x2 - x1;
  var D = y2 - y1;

  var dot = A * C + B * D;
  var len_sq = C * C + D * D;
  var dx, dy;
  if (len_sq == 0) {
    // start and end of the segment coincide
    dx = x - x1;
    dy = y - y1;
  } else {
    var param = dot / len_sq;
    var xx, yy;
    if (param < 0) {
      xx = x1;
      yy = y1;
    } else if (param > 1) {
      xx = x2;
      yy = y2;
    } else {
      xx = x1 + param * C;
      yy = y1 + param * D;
    }
    dx = x - xx;
    dy = y - yy;
  }
  return dx * dx + dy * dy <= d * d;
}

function modulo(n, mod) {
  return ((n % mod) + mod) % mod;
}

function pointWithinDistanceToArc(x, y, xc, yc, radius, startangle, endangle, d) {
  var dx = x - xc;
  var dy = y - yc;
  var r_sq = dx * dx + dy * dy;
  var rmin = Math.max(0, radius - d);
  var rmax = radius + d;

  if (r_sq < rmin * rmin || r_sq > rmax * rmax)
    return false;

  var angle1 = modulo(deg2rad(startangle), 2 * Math.PI);
  var dx1 = xc + radius * Math.cos(angle1) - x;
  var dy1 = yc + radius * Math.sin(angle1) - y;
  if (dx1 * dx1 + dy1 * dy1 <= d * d)
    return true;

  var angle2 = modulo(deg2rad(endangle), 2 * Math.PI);
  var dx2 = xc + radius * Math.cos(angle2) - x;
  var dy2 = yc + radius * Math.sin(angle2) - y;
  if (dx2 * dx2 + dy2 * dy2 <= d * d)
    return true;

  var angle = modulo(Math.atan2(dy, dx), 2 * Math.PI);
  if (angle1 > angle2)
    return (angle >= angle2 || angle <= angle1);
  else
    return (angle >= angle1 && angle <= angle2);
}

function pointWithinPad(x, y, pad) {
  var v = [x - pad.pos[0], y - pad.pos[1]];
  v = rotateVector(v, -pad.angle);
  if (pad.offset) {
    v[0] -= pad.offset[0];
    v[1] -= pad.offset[1];
  }
  return emptyContext2d.isPointInPath(getCachedPadPath(pad), ...v);
}

function netHitScan(layer, x, y) {
  // Check track segments
  if (settings.renderTracks && pcbdata.tracks) {
    for (var track of pcbdata.tracks[layer]) {
      if ('radius' in track) {
        if (pointWithinDistanceToArc(x, y, ...track.center, track.radius, track.startangle, track.endangle, track.width / 2)) {
          return track.net;
        }
      } else {
        if (pointWithinDistanceToSegment(x, y, ...track.start, ...track.end, track.width / 2)) {
          return track.net;
        }
      }
    }
  }
  // Check pads
  if (settings.renderPads) {
    for (var footprint of pcbdata.footprints) {
      for (var pad of footprint.pads) {
        if (pad.layers.includes(layer) && pointWithinPad(x, y, pad)) {
          return pad.net;
        }
      }
    }
  }
  return null;
}

function pointWithinFootprintBbox(x, y, bbox) {
  var v = [x - bbox.pos[0], y - bbox.pos[1]];
  v = rotateVector(v, bbox.angle);
  return bbox.relpos[0] <= v[0] && v[0] <= bbox.relpos[0] + bbox.size[0] &&
    bbox.relpos[1] <= v[1] && v[1] <= bbox.relpos[1] + bbox.size[1];
}

function bboxHitScan(layer, x, y) {
  var result = [];
  for (var i = 0; i < pcbdata.footprints.length; i++) {
    var footprint = pcbdata.footprints[i];
    if (footprint.layer == layer) {
      if (pointWithinFootprintBbox(x, y, footprint.bbox)) {
        result.push(i);
      }
    }
  }
  return result;
}

function handlePointerDown(e, layerdict) {
  if (e.button != 0 && e.button != 1) {
    return;
  }
  e.preventDefault();
  e.stopPropagation();

  if (!e.hasOwnProperty("offsetX")) {
    // The polyfill doesn't set this properly
    e.offsetX = e.pageX - e.currentTarget.offsetLeft;
    e.offsetY = e.pageY - e.currentTarget.offsetTop;
  }

  layerdict.pointerStates[e.pointerId] = {
    distanceTravelled: 0,
    lastX: e.offsetX,
    lastY: e.offsetY,
    downTime: Date.now(),
  };
}

function handleMouseClick(e, layerdict) {
  if (!e.hasOwnProperty("offsetX")) {
    // The polyfill doesn't set this properly
    e.offsetX = e.pageX - e.currentTarget.offsetLeft;
    e.offsetY = e.pageY - e.currentTarget.offsetTop;
  }

  var x = e.offsetX;
  var y = e.offsetY;
  var t = layerdict.transform;
  if (layerdict.layer == "B") {
    x = (devicePixelRatio * x / t.zoom - t.panx + t.x) / -t.s;
  } else {
    x = (devicePixelRatio * x / t.zoom - t.panx - t.x) / t.s;
  }
  y = (devicePixelRatio * y / t.zoom - t.y - t.pany) / t.s;
  var v = rotateVector([x, y], -settings.boardRotation);
  if ("nets" in pcbdata) {
    var net = netHitScan(layerdict.layer, ...v);
    if (net !== highlightedNet) {
      netClicked(net);
    }
  }
  if (highlightedNet === null) {
    var footprints = bboxHitScan(layerdict.layer, ...v);
    if (footprints.length > 0) {
      footprintsClicked(footprints);
    }
  }
}

function handlePointerLeave(e, layerdict) {
  e.preventDefault();
  e.stopPropagation();

  if (!settings.redrawOnDrag) {
    redrawCanvas(layerdict);
  }

  delete layerdict.pointerStates[e.pointerId];
}

function resetTransform(layerdict) {
  layerdict.transform.panx = 0;
  layerdict.transform.pany = 0;
  layerdict.transform.zoom = 1;
  redrawCanvas(layerdict);
}

function handlePointerUp(e, layerdict) {
  if (!e.hasOwnProperty("offsetX")) {
    // The polyfill doesn't set this properly
    e.offsetX = e.pageX - e.currentTarget.offsetLeft;
    e.offsetY = e.pageY - e.currentTarget.offsetTop;
  }

  e.preventDefault();
  e.stopPropagation();

  if (e.button == 2) {
    // Reset pan and zoom on right click.
    resetTransform(layerdict);
    layerdict.anotherPointerTapped = false;
    return;
  }

  // We haven't necessarily had a pointermove event since the interaction started, so make sure we update this now
  var ptr = layerdict.pointerStates[e.pointerId];
  ptr.distanceTravelled += Math.abs(e.offsetX - ptr.lastX) + Math.abs(e.offsetY - ptr.lastY);

  if (e.button == 0 && ptr.distanceTravelled < 10 && Date.now() - ptr.downTime <= 500) {
    if (Object.keys(layerdict.pointerStates).length == 1) {
      if (layerdict.anotherPointerTapped) {
        // This is the second pointer coming off of a two-finger tap
        resetTransform(layerdict);
      } else {
        // This is just a regular tap
        handleMouseClick(e, layerdict);
      }
      layerdict.anotherPointerTapped = false;
    } else {
      // This is the first finger coming off of what could become a two-finger tap
      layerdict.anotherPointerTapped = true;
    }
  } else {
    if (!settings.redrawOnDrag) {
      redrawCanvas(layerdict);
    }
    layerdict.anotherPointerTapped = false;
  }

  delete layerdict.pointerStates[e.pointerId];
}

function handlePointerMove(e, layerdict) {
  if (!layerdict.pointerStates.hasOwnProperty(e.pointerId)) {
    return;
  }
  e.preventDefault();
  e.stopPropagation();

  if (!e.hasOwnProperty("offsetX")) {
    // The polyfill doesn't set this properly
    e.offsetX = e.pageX - e.currentTarget.offsetLeft;
    e.offsetY = e.pageY - e.currentTarget.offsetTop;
  }

  var thisPtr = layerdict.pointerStates[e.pointerId];

  var dx = e.offsetX - thisPtr.lastX;
  var dy = e.offsetY - thisPtr.lastY;

  // If this number is low on pointer up, we count the action as a click
  thisPtr.distanceTravelled += Math.abs(dx) + Math.abs(dy);

  if (Object.keys(layerdict.pointerStates).length == 1) {
    // This is a simple drag
    layerdict.transform.panx += devicePixelRatio * dx / layerdict.transform.zoom;
    layerdict.transform.pany += devicePixelRatio * dy / layerdict.transform.zoom;
  } else if (Object.keys(layerdict.pointerStates).length == 2) {
    var otherPtr = Object.values(layerdict.pointerStates).filter((ptr) => ptr != thisPtr)[0];

    var oldDist = Math.sqrt(Math.pow(thisPtr.lastX - otherPtr.lastX, 2) + Math.pow(thisPtr.lastY - otherPtr.lastY, 2));
    var newDist = Math.sqrt(Math.pow(e.offsetX - otherPtr.lastX, 2) + Math.pow(e.offsetY - otherPtr.lastY, 2));

    var scaleFactor = newDist / oldDist;

    if (scaleFactor != NaN) {
      layerdict.transform.zoom *= scaleFactor;

      var zoomd = (1 - scaleFactor) / layerdict.transform.zoom;
      layerdict.transform.panx += devicePixelRatio * otherPtr.lastX * zoomd;
      layerdict.transform.pany += devicePixelRatio * otherPtr.lastY * zoomd;
    }
  }

  thisPtr.lastX = e.offsetX;
  thisPtr.lastY = e.offsetY;

  if (settings.redrawOnDrag) {
    redrawCanvas(layerdict);
  }
}

function handleMouseWheel(e, layerdict) {
  e.preventDefault();
  e.stopPropagation();
  var t = layerdict.transform;
  var wheeldelta = e.deltaY;
  if (e.deltaMode == 1) {
    // FF only, scroll by lines
    wheeldelta *= 30;
  } else if (e.deltaMode == 2) {
    wheeldelta *= 300;
  }
  var m = Math.pow(1.1, -wheeldelta / 40);
  // Limit amount of zoom per tick.
  if (m > 2) {
    m = 2;
  } else if (m < 0.5) {
    m = 0.5;
  }
  t.zoom *= m;
  var zoomd = (1 - m) / t.zoom;
  t.panx += devicePixelRatio * e.offsetX * zoomd;
  t.pany += devicePixelRatio * e.offsetY * zoomd;
  redrawCanvas(layerdict);
}

function addMouseHandlers(div, layerdict) {
  div.addEventListener("pointerdown", function(e) {
    handlePointerDown(e, layerdict);
  });
  div.addEventListener("pointermove", function(e) {
    handlePointerMove(e, layerdict);
  });
  div.addEventListener("pointerup", function(e) {
    handlePointerUp(e, layerdict);
  });
  var pointerleave = function(e) {
    handlePointerLeave(e, layerdict);
  }
  div.addEventListener("pointercancel", pointerleave);
  div.addEventListener("pointerleave", pointerleave);
  div.addEventListener("pointerout", pointerleave);

  div.onwheel = function(e) {
    handleMouseWheel(e, layerdict);
  }
  for (var element of [div, layerdict.bg, layerdict.fab, layerdict.silk, layerdict.highlight]) {
    element.addEventListener("contextmenu", function(e) {
      e.preventDefault();
    }, false);
  }
}

function setRedrawOnDrag(value) {
  settings.redrawOnDrag = value;
  writeStorage("redrawOnDrag", value);
}

function setBoardRotation(value) {
  settings.boardRotation = value * 5;
  writeStorage("boardRotation", settings.boardRotation);
  document.getElementById("rotationDegree").textContent = settings.boardRotation;
  resizeAll();
}

function initRender() {
  allcanvas = {
    front: {
      transform: {
        x: 0,
        y: 0,
        s: 1,
        panx: 0,
        pany: 0,
        zoom: 1,
      },
      pointerStates: {},
      anotherPointerTapped: false,
      bg: document.getElementById("F_bg"),
      fab: document.getElementById("F_fab"),
      silk: document.getElementById("F_slk"),
      highlight: document.getElementById("F_hl"),
      layer: "F",
    },
    back: {
      transform: {
        x: 0,
        y: 0,
        s: 1,
        panx: 0,
        pany: 0,
        zoom: 1,
      },
      pointerStates: {},
      anotherPointerTapped: false,
      bg: document.getElementById("B_bg"),
      fab: document.getElementById("B_fab"),
      silk: document.getElementById("B_slk"),
      highlight: document.getElementById("B_hl"),
      layer: "B",
    }
  };
  addMouseHandlers(document.getElementById("frontcanvas"), allcanvas.front);
  addMouseHandlers(document.getElementById("backcanvas"), allcanvas.back);
}

///////////////////////////////////////////////

///////////////////////////////////////////////
/*
 * Table reordering via Drag'n'Drop
 * Inspired by: https://htmldom.dev/drag-and-drop-table-column
 */

function setBomHandlers() {

  const bom = document.getElementById('bomtable');

  let dragName;
  let placeHolderElements;
  let draggingElement;
  let forcePopulation;
  let xOffset;
  let yOffset;
  let wasDragged;

  const mouseUpHandler = function(e) {
    // Delete dragging element
    draggingElement.remove();

    // Make BOM selectable again
    bom.style.removeProperty("userSelect");

    // Remove listeners
    document.removeEventListener('mousemove', mouseMoveHandler);
    document.removeEventListener('mouseup', mouseUpHandler);

    if (wasDragged) {
      // Redraw whole BOM
      populateBomTable();
    }
  }

  const mouseMoveHandler = function(e) {
    // Notice the dragging
    wasDragged = true;

    // Make the dragged element visible
    draggingElement.style.removeProperty("display");

    // Set elements position to mouse position
    draggingElement.style.left = `${e.screenX - xOffset}px`;
    draggingElement.style.top = `${e.screenY - yOffset}px`;

    // Forced redrawing of BOM table
    if (forcePopulation) {
      forcePopulation = false;
      // Copy array
      phe = Array.from(placeHolderElements);
      // populate BOM table again
      populateBomHeader(dragName, phe);
      populateBomBody(dragName, phe);
    }

    // Set up array of hidden columns
    var hiddenColumns = Array.from(settings.hiddenColumns);
    // In the ungrouped mode, quantity don't exist
    if (settings.bommode === "ungrouped")
      hiddenColumns.push("Quantity");
    // If no checkbox fields can be found, we consider them hidden
    if (settings.checkboxes.length == 0)
      hiddenColumns.push("checkboxes");

    // Get table headers and group them into checkboxes, extrafields and normal headers
    const bh = document.getElementById("bomhead");
    headers = Array.from(bh.querySelectorAll("th"))
    headers.shift() // numCol is not part of the columnOrder
    headerGroups = []
    lastCompoundClass = null;
    for (i = 0; i < settings.columnOrder.length; i++) {
      cElem = settings.columnOrder[i];
      if (hiddenColumns.includes(cElem)) {
        // Hidden columns appear as a dummy element
        headerGroups.push([]);
        continue;
      }
      elem = headers.filter(e => getColumnOrderName(e) === cElem)[0];
      if (elem.classList.contains("bom-checkbox")) {
        if (lastCompoundClass === "bom-checkbox") {
          cbGroup = headerGroups.pop();
          cbGroup.push(elem);
          headerGroups.push(cbGroup);
        } else {
          lastCompoundClass = "bom-checkbox";
          headerGroups.push([elem])
        }
      } else {
        headerGroups.push([elem])
      }
    }

    // Copy settings.columnOrder
    var columns = Array.from(settings.columnOrder)

    // Set up array with indices of hidden columns
    var hiddenIndices = hiddenColumns.map(e => settings.columnOrder.indexOf(e));
    var dragIndex = columns.indexOf(dragName);
    var swapIndex = dragIndex;
    var swapDone = false;

    // Check if the current dragged element is swapable with the left or right element
    if (dragIndex > 0) {
      // Get left headers boundingbox
      swapIndex = dragIndex - 1;
      while (hiddenIndices.includes(swapIndex) && swapIndex > 0)
        swapIndex--;
      if (!hiddenIndices.includes(swapIndex)) {
        box = getBoundingClientRectFromMultiple(headerGroups[swapIndex]);
        if (e.clientX < box.left + window.scrollX + (box.width / 2)) {
          swapElement = columns[dragIndex];
          columns.splice(dragIndex, 1);
          columns.splice(swapIndex, 0, swapElement);
          forcePopulation = true;
          swapDone = true;
        }
      }
    }
    if ((!swapDone) && dragIndex < headerGroups.length - 1) {
      // Get right headers boundingbox
      swapIndex = dragIndex + 1;
      while (hiddenIndices.includes(swapIndex))
        swapIndex++;
      if (swapIndex < headerGroups.length) {
        box = getBoundingClientRectFromMultiple(headerGroups[swapIndex]);
        if (e.clientX > box.left + window.scrollX + (box.width / 2)) {
          swapElement = columns[dragIndex];
          columns.splice(dragIndex, 1);
          columns.splice(swapIndex, 0, swapElement);
          forcePopulation = true;
          swapDone = true;
        }
      }
    }

    // Write back change to storage
    if (swapDone) {
      settings.columnOrder = columns
      writeStorage("columnOrder", JSON.stringify(columns));
    }

  }

  const mouseDownHandler = function(e) {
    var target = e.target;
    if (target.tagName.toLowerCase() != "td")
      target = target.parentElement;

    // Used to check if a dragging has ever happened
    wasDragged = false;

    // Create new element which will be displayed as the dragged column
    draggingElement = document.createElement("div")
    draggingElement.classList.add("dragging");
    draggingElement.style.display = "none";
    draggingElement.style.position = "absolute";
    draggingElement.style.overflow = "hidden";

    // Get bomhead and bombody elements
    const bh = document.getElementById("bomhead");
    const bb = document.getElementById("bombody");

    // Get all compound headers for the current column
    var compoundHeaders;
    if (target.classList.contains("bom-checkbox")) {
      compoundHeaders = Array.from(bh.querySelectorAll("th.bom-checkbox"));
    } else {
      compoundHeaders = [target];
    }

    // Create new table which will display the column
    var newTable = document.createElement("table");
    newTable.classList.add("bom");
    newTable.style.background = "white";
    draggingElement.append(newTable);

    // Create new header element
    var newHeader = document.createElement("thead");
    newTable.append(newHeader);

    // Set up array for storing all placeholder elements
    placeHolderElements = [];

    // Add all compound headers to the new thead element and placeholders
    compoundHeaders.forEach(function(h) {
      clone = cloneElementWithDimensions(h);
      newHeader.append(clone);
      placeHolderElements.push(clone);
    });

    // Create new body element
    var newBody = document.createElement("tbody");
    newTable.append(newBody);

    // Get indices for compound headers
    var idxs = compoundHeaders.map(e => getBomTableHeaderIndex(e));

    // For each row in the BOM body...
    var rows = bb.querySelectorAll("tr");
    rows.forEach(function(row) {
      // ..get the cells for the compound column
      const tds = row.querySelectorAll("td");
      var copytds = idxs.map(i => tds[i]);
      // Add them to the new element and the placeholders
      var newRow = document.createElement("tr");
      copytds.forEach(function(td) {
        clone = cloneElementWithDimensions(td);
        newRow.append(clone);
        placeHolderElements.push(clone);
      });
      newBody.append(newRow);
    });

    // Compute width for compound header
    var width = compoundHeaders.reduce((acc, x) => acc + x.clientWidth, 0);
    draggingElement.style.width = `${width}px`;

    // Insert the new dragging element and disable selection on BOM
    bom.insertBefore(draggingElement, null);
    bom.style.userSelect = "none";

    // Determine the mouse position offset
    xOffset = e.screenX - compoundHeaders.reduce((acc, x) => Math.min(acc, x.offsetLeft), compoundHeaders[0].offsetLeft);
    yOffset = e.screenY - compoundHeaders[0].offsetTop;

    // Get name for the column in settings.columnOrder
    dragName = getColumnOrderName(target);

    // Change text and class for placeholder elements
    placeHolderElements = placeHolderElements.map(function(e) {
      newElem = cloneElementWithDimensions(e);
      newElem.textContent = "";
      newElem.classList.add("placeholder");
      return newElem;
    });

    // On next mouse move, the whole BOM needs to be redrawn to show the placeholders
    forcePopulation = true;

    // Add listeners for move and up on mouse
    document.addEventListener('mousemove', mouseMoveHandler);
    document.addEventListener('mouseup', mouseUpHandler);
  }

  // In netlist mode, there is nothing to reorder
  if (settings.bommode === "netlist")
    return;

  // Add mouseDownHandler to every column except the numCol
  bom.querySelectorAll("th")
    .forEach(function(head) {
      if (!head.classList.contains("numCol")) {
        head.onmousedown = mouseDownHandler;
      }
    });

}

function getBoundingClientRectFromMultiple(elements) {
  var elems = Array.from(elements);

  if (elems.length == 0)
    return null;

  var box = elems.shift()
    .getBoundingClientRect();

  elems.forEach(function(elem) {
    var elembox = elem.getBoundingClientRect();
    box.left = Math.min(elembox.left, box.left);
    box.top = Math.min(elembox.top, box.top);
    box.width += elembox.width;
    box.height = Math.max(elembox.height, box.height);
  });

  return box;
}

function cloneElementWithDimensions(elem) {
  var newElem = elem.cloneNode(true);
  newElem.style.height = window.getComputedStyle(elem).height;
  newElem.style.width = window.getComputedStyle(elem).width;
  return newElem;
}

function getBomTableHeaderIndex(elem) {
  const bh = document.getElementById('bomhead');
  const ths = Array.from(bh.querySelectorAll("th"));
  return ths.indexOf(elem);
}

function getColumnOrderName(elem) {
  var cname = elem.getAttribute("col_name");
  if (cname === "bom-checkbox")
    return "checkboxes";
  else
    return cname;
}

function resizableGrid(tablehead) {
  var cols = tablehead.firstElementChild.children;
  var rowWidth = tablehead.offsetWidth;

  for (var i = 1; i < cols.length; i++) {
    if (cols[i].classList.contains("bom-checkbox"))
      continue;
    cols[i].style.width = ((cols[i].clientWidth - paddingDiff(cols[i])) * 100 / rowWidth) + '%';
  }

  for (var i = 1; i < cols.length - 1; i++) {
    var div = document.createElement('div');
    div.className = "column-width-handle";
    cols[i].appendChild(div);
    setListeners(div);
  }

  function setListeners(div) {
    var startX, curCol, nxtCol, curColWidth, nxtColWidth, rowWidth;

    div.addEventListener('mousedown', function(e) {
      e.preventDefault();
      e.stopPropagation();

      curCol = e.target.parentElement;
      nxtCol = curCol.nextElementSibling;
      startX = e.pageX;

      var padding = paddingDiff(curCol);

      rowWidth = curCol.parentElement.offsetWidth;
      curColWidth = curCol.clientWidth - padding;
      nxtColWidth = nxtCol.clientWidth - padding;
    });

    document.addEventListener('mousemove', function(e) {
      if (startX) {
        var diffX = e.pageX - startX;
        diffX = -Math.min(-diffX, curColWidth - 20);
        diffX = Math.min(diffX, nxtColWidth - 20);

        curCol.style.width = ((curColWidth + diffX) * 100 / rowWidth) + '%';
        nxtCol.style.width = ((nxtColWidth - diffX) * 100 / rowWidth) + '%';
        console.log(`${curColWidth + nxtColWidth} ${(curColWidth + diffX) * 100 / rowWidth + (nxtColWidth - diffX) * 100 / rowWidth}`);
      }
    });

    document.addEventListener('mouseup', function(e) {
      curCol = undefined;
      nxtCol = undefined;
      startX = undefined;
      nxtColWidth = undefined;
      curColWidth = undefined
    });
  }

  function paddingDiff(col) {

    if (getStyleVal(col, 'box-sizing') == 'border-box') {
      return 0;
    }

    var padLeft = getStyleVal(col, 'padding-left');
    var padRight = getStyleVal(col, 'padding-right');
    return (parseInt(padLeft) + parseInt(padRight));

  }

  function getStyleVal(elm, css) {
    return (window.getComputedStyle(elm, null).getPropertyValue(css))
  }
}

///////////////////////////////////////////////

///////////////////////////////////////////////
/* DOM manipulation and misc code */

var bomsplit;
var canvassplit;
var initDone = false;
var bomSortFunction = null;
var currentSortColumn = null;
var currentSortOrder = null;
var currentHighlightedRowId;
var highlightHandlers = [];
var footprintIndexToHandler = {};
var netsToHandler = {};
var markedFootprints = new Set();
var highlightedFootprints = [];
var highlightedNet = null;
var lastClicked;

function dbg(html) {
  dbgdiv.innerHTML = html;
}

function redrawIfInitDone() {
  if (initDone) {
    redrawCanvas(allcanvas.front);
    redrawCanvas(allcanvas.back);
  }
}

function padsVisible(value) {
  writeStorage("padsVisible", value);
  settings.renderPads = value;
  redrawIfInitDone();
}

function referencesVisible(value) {
  writeStorage("referencesVisible", value);
  settings.renderReferences = value;
  redrawIfInitDone();
}

function valuesVisible(value) {
  writeStorage("valuesVisible", value);
  settings.renderValues = value;
  redrawIfInitDone();
}

function tracksVisible(value) {
  writeStorage("tracksVisible", value);
  settings.renderTracks = value;
  redrawIfInitDone();
}

function zonesVisible(value) {
  writeStorage("zonesVisible", value);
  settings.renderZones = value;
  redrawIfInitDone();
}

function dnpOutline(value) {
  writeStorage("dnpOutline", value);
  settings.renderDnpOutline = value;
  redrawIfInitDone();
}

function setDarkMode(value) {
  if (value) {
    topmostdiv.classList.add("dark");
  } else {
    topmostdiv.classList.remove("dark");
  }
  writeStorage("darkmode", value);
  settings.darkMode = value;
  redrawIfInitDone();
}

function setShowBOMColumn(field, value) {
  if (field === "references") {
    var rl = document.getElementById("reflookup");
    rl.disabled = !value;
    if (!value) {
      rl.value = "";
      updateRefLookup("");
    }
  }

  var n = settings.hiddenColumns.indexOf(field);
  if (value) {
    if (n != -1) {
      settings.hiddenColumns.splice(n, 1);
    }
  } else {
    if (n == -1) {
      settings.hiddenColumns.push(field);
    }
  }

  writeStorage("hiddenColumns", JSON.stringify(settings.hiddenColumns));

  if (initDone) {
    populateBomTable();
  }

  redrawIfInitDone();
}


function setFullscreen(value) {
  if (value) {
    document.documentElement.requestFullscreen();
  } else {
    document.exitFullscreen();
  }
}

function fabricationVisible(value) {
  writeStorage("fabricationVisible", value);
  settings.renderFabrication = value;
  redrawIfInitDone();
}

function silkscreenVisible(value) {
  writeStorage("silkscreenVisible", value);
  settings.renderSilkscreen = value;
  redrawIfInitDone();
}

function setHighlightPin1(value) {
  writeStorage("highlightpin1", value);
  settings.highlightpin1 = value;
  redrawIfInitDone();
}

function getStoredCheckboxRefs(checkbox) {
  function convert(ref) {
    var intref = parseInt(ref);
    if (isNaN(intref)) {
      for (var i = 0; i < pcbdata.footprints.length; i++) {
        if (pcbdata.footprints[i].ref == ref) {
          return i;
        }
      }
      return -1;
    } else {
      return intref;
    }
  }
  if (!(checkbox in settings.checkboxStoredRefs)) {
    var val = readStorage("checkbox_" + checkbox);
    settings.checkboxStoredRefs[checkbox] = val ? val : "";
  }
  if (!settings.checkboxStoredRefs[checkbox]) {
    return new Set();
  } else {
    return new Set(settings.checkboxStoredRefs[checkbox].split(",").map(r => convert(r)).filter(a => a >= 0));
  }
}

function getCheckboxState(checkbox, references) {
  var storedRefsSet = getStoredCheckboxRefs(checkbox);
  var currentRefsSet = new Set(references.map(r => r[1]));
  // Get difference of current - stored
  var difference = new Set(currentRefsSet);
  for (ref of storedRefsSet) {
    difference.delete(ref);
  }
  if (difference.size == 0) {
    // All the current refs are stored
    return "checked";
  } else if (difference.size == currentRefsSet.size) {
    // None of the current refs are stored
    return "unchecked";
  } else {
    // Some of the refs are stored
    return "indeterminate";
  }
}

function setBomCheckboxState(checkbox, element, references) {
  var state = getCheckboxState(checkbox, references);
  element.checked = (state == "checked");
  element.indeterminate = (state == "indeterminate");
}

function createCheckboxChangeHandler(checkbox, references, row) {
  return function () {
    refsSet = getStoredCheckboxRefs(checkbox);
    var markWhenChecked = settings.markWhenChecked == checkbox;
    eventArgs = {
      checkbox: checkbox,
      refs: references,
    }
    if (this.checked) {
      // checkbox ticked
      for (var ref of references) {
        refsSet.add(ref[1]);
      }
      if (markWhenChecked) {
        row.classList.add("checked");
        for (var ref of references) {
          markedFootprints.add(ref[1]);
        }
        drawHighlights();
      }
      eventArgs.state = 'checked';
    } else {
      // checkbox unticked
      for (var ref of references) {
        refsSet.delete(ref[1]);
      }
      if (markWhenChecked) {
        row.classList.remove("checked");
        for (var ref of references) {
          markedFootprints.delete(ref[1]);
        }
        drawHighlights();
      }
      eventArgs.state = 'unchecked';
    }
    settings.checkboxStoredRefs[checkbox] = [...refsSet].join(",");
    writeStorage("checkbox_" + checkbox, settings.checkboxStoredRefs[checkbox]);
    updateCheckboxStats(checkbox);
    EventHandler.emitEvent(IBOM_EVENT_TYPES.CHECKBOX_CHANGE_EVENT, eventArgs);
  }
}

function clearHighlightedFootprints() {
  if (currentHighlightedRowId) {
    document.getElementById(currentHighlightedRowId).classList.remove("highlighted");
    currentHighlightedRowId = null;
    highlightedFootprints = [];
    highlightedNet = null;
  }
}

function createRowHighlightHandler(rowid, refs, net) {
  return function () {
    if (currentHighlightedRowId) {
      if (currentHighlightedRowId == rowid) {
        return;
      }
      document.getElementById(currentHighlightedRowId).classList.remove("highlighted");
    }
    document.getElementById(rowid).classList.add("highlighted");
    currentHighlightedRowId = rowid;
    highlightedFootprints = refs ? refs.map(r => r[1]) : [];
    highlightedNet = net;
    drawHighlights();
    EventHandler.emitEvent(
      IBOM_EVENT_TYPES.HIGHLIGHT_EVENT, {
      rowid: rowid,
      refs: refs,
      net: net
    });
  }
}

function entryMatches(entry) {
  if (settings.bommode == "netlist") {
    // entry is just a net name
    return entry.toLowerCase().indexOf(filter) >= 0;
  }
  // check refs
  if (!settings.hiddenColumns.includes("references")) {
    for (var ref of entry) {
      if (ref[0].toLowerCase().indexOf(filter) >= 0) {
        return true;
      }
    }
  }
  // check fields
  for (var i in config.fields) {
    var f = config.fields[i];
    if (!settings.hiddenColumns.includes(f)) {
      for (var ref of entry) {
        if (pcbdata.bom.fields[ref[1]][i].toLowerCase().indexOf(filter) >= 0) {
          return true;
        }
      }
    }
  }
  return false;
}

function findRefInEntry(entry) {
  return entry.filter(r => r[0].toLowerCase() == reflookup);
}

function highlightFilter(s) {
  if (!filter) {
    return s;
  }
  var parts = s.toLowerCase().split(filter);
  if (parts.length == 1) {
    return s;
  }
  var r = "";
  var pos = 0;
  for (var i in parts) {
    if (i > 0) {
      r += '<mark class="highlight">' +
        s.substring(pos, pos + filter.length) +
        '</mark>';
      pos += filter.length;
    }
    r += s.substring(pos, pos + parts[i].length);
    pos += parts[i].length;
  }
  return r;
}

function checkboxSetUnsetAllHandler(checkboxname) {
  return function () {
    var checkboxnum = 0;
    while (checkboxnum < settings.checkboxes.length &&
      settings.checkboxes[checkboxnum].toLowerCase() != checkboxname.toLowerCase()) {
      checkboxnum++;
    }
    if (checkboxnum >= settings.checkboxes.length) {
      return;
    }
    var allset = true;
    var checkbox;
    var row;
    for (row of bombody.childNodes) {
      checkbox = row.childNodes[checkboxnum + 1].childNodes[0];
      if (!checkbox.checked || checkbox.indeterminate) {
        allset = false;
        break;
      }
    }
    for (row of bombody.childNodes) {
      checkbox = row.childNodes[checkboxnum + 1].childNodes[0];
      checkbox.checked = !allset;
      checkbox.indeterminate = false;
      checkbox.onchange();
    }
  }
}

function createColumnHeader(name, cls, comparator, is_checkbox = false) {
  var th = document.createElement("TH");
  th.innerHTML = name;
  th.classList.add(cls);
  if (is_checkbox)
    th.setAttribute("col_name", "bom-checkbox");
  else
    th.setAttribute("col_name", name);
  var span = document.createElement("SPAN");
  span.classList.add("sortmark");
  span.classList.add("none");
  th.appendChild(span);
  var spacer = document.createElement("div");
  spacer.className = "column-spacer";
  th.appendChild(spacer);
  spacer.onclick = function () {
    if (currentSortColumn && th !== currentSortColumn) {
      // Currently sorted by another column
      currentSortColumn.childNodes[1].classList.remove(currentSortOrder);
      currentSortColumn.childNodes[1].classList.add("none");
      currentSortColumn = null;
      currentSortOrder = null;
    }
    if (currentSortColumn && th === currentSortColumn) {
      // Already sorted by this column
      if (currentSortOrder == "asc") {
        // Sort by this column, descending order
        bomSortFunction = function (a, b) {
          return -comparator(a, b);
        }
        currentSortColumn.childNodes[1].classList.remove("asc");
        currentSortColumn.childNodes[1].classList.add("desc");
        currentSortOrder = "desc";
      } else {
        // Unsort
        bomSortFunction = null;
        currentSortColumn.childNodes[1].classList.remove("desc");
        currentSortColumn.childNodes[1].classList.add("none");
        currentSortColumn = null;
        currentSortOrder = null;
      }
    } else {
      // Sort by this column, ascending order
      bomSortFunction = comparator;
      currentSortColumn = th;
      currentSortColumn.childNodes[1].classList.remove("none");
      currentSortColumn.childNodes[1].classList.add("asc");
      currentSortOrder = "asc";
    }
    populateBomBody();
  }
  if (is_checkbox) {
    spacer.onclick = fancyDblClickHandler(
      spacer, spacer.onclick, checkboxSetUnsetAllHandler(name));
  }
  return th;
}

function populateBomHeader(placeHolderColumn = null, placeHolderElements = null) {
  while (bomhead.firstChild) {
    bomhead.removeChild(bomhead.firstChild);
  }
  var tr = document.createElement("TR");
  var th = document.createElement("TH");
  th.classList.add("numCol");

  var vismenu = document.createElement("div");
  vismenu.id = "vismenu";
  vismenu.classList.add("menu");

  var visbutton = document.createElement("div");
  visbutton.classList.add("visbtn");
  visbutton.classList.add("hideonprint");

  var viscontent = document.createElement("div");
  viscontent.classList.add("menu-content");
  viscontent.id = "vismenu-content";

  settings.columnOrder.forEach(column => {
    if (typeof column !== "string")
      return;

    // Skip empty columns
    if (column === "checkboxes" && settings.checkboxes.length == 0)
      return;
    else if (column === "Quantity" && settings.bommode == "ungrouped")
      return;

    var label = document.createElement("label");
    label.classList.add("menu-label");

    var input = document.createElement("input");
    input.classList.add("visibility_checkbox");
    input.type = "checkbox";
    input.onchange = function (e) {
      setShowBOMColumn(column, e.target.checked)
    };
    input.checked = !(settings.hiddenColumns.includes(column));

    label.appendChild(input);
    if (column.length > 0)
      label.append(column[0].toUpperCase() + column.slice(1));

    viscontent.appendChild(label);
  });

  viscontent.childNodes[0].classList.add("menu-label-top");

  vismenu.appendChild(visbutton);
  if (settings.bommode != "netlist") {
    vismenu.appendChild(viscontent);
    th.appendChild(vismenu);
  }
  tr.appendChild(th);

  var checkboxCompareClosure = function (checkbox) {
    return (a, b) => {
      var stateA = getCheckboxState(checkbox, a);
      var stateB = getCheckboxState(checkbox, b);
      if (stateA > stateB) return -1;
      if (stateA < stateB) return 1;
      return 0;
    }
  }
  var stringFieldCompareClosure = function (fieldIndex) {
    return (a, b) => {
      var fa = pcbdata.bom.fields[a[0][1]][fieldIndex];
      var fb = pcbdata.bom.fields[b[0][1]][fieldIndex];
      if (fa != fb) return fa > fb ? 1 : -1;
      else return 0;
    }
  }
  var referenceRegex = /(?<prefix>[^0-9]+)(?<number>[0-9]+)/;
  var compareRefs = (a, b) => {
    var ra = referenceRegex.exec(a);
    var rb = referenceRegex.exec(b);
    if (ra === null || rb === null) {
      if (a != b) return a > b ? 1 : -1;
      return 0;
    } else {
      if (ra.groups.prefix != rb.groups.prefix) {
        return ra.groups.prefix > rb.groups.prefix ? 1 : -1;
      }
      if (ra.groups.number != rb.groups.number) {
        return parseInt(ra.groups.number) > parseInt(rb.groups.number) ? 1 : -1;
      }
      return 0;
    }
  }
  if (settings.bommode == "netlist") {
    th = createColumnHeader("Net name", "bom-netname", (a, b) => {
      if (a > b) return -1;
      if (a < b) return 1;
      return 0;
    });
    tr.appendChild(th);
  } else {
    // Filter hidden columns
    var columns = settings.columnOrder.filter(e => !settings.hiddenColumns.includes(e));
    var valueIndex = config.fields.indexOf("Value");
    var footprintIndex = config.fields.indexOf("Footprint");
    columns.forEach((column) => {
      if (column === placeHolderColumn) {
        var n = 1;
        if (column === "checkboxes")
          n = settings.checkboxes.length;
        for (i = 0; i < n; i++) {
          td = placeHolderElements.shift();
          tr.appendChild(td);
        }
        return;
      } else if (column === "checkboxes") {
        for (var checkbox of settings.checkboxes) {
          th = createColumnHeader(
            checkbox, "bom-checkbox", checkboxCompareClosure(checkbox), true);
          tr.appendChild(th);
        }
      } else if (column === "References") {
        tr.appendChild(createColumnHeader("References", "references", (a, b) => {
          var i = 0;
          while (i < a.length && i < b.length) {
            if (a[i] != b[i]) return compareRefs(a[i][0], b[i][0]);
            i++;
          }
          return a.length - b.length;
        }));
      } else if (column === "Value") {
        tr.appendChild(createColumnHeader("Value", "value", (a, b) => {
          var ra = a[0][1], rb = b[0][1];
          return valueCompare(
            pcbdata.bom.parsedValues[ra], pcbdata.bom.parsedValues[rb],
            pcbdata.bom.fields[ra][valueIndex], pcbdata.bom.fields[rb][valueIndex]);
        }));
        return;
      } else if (column === "Footprint") {
        tr.appendChild(createColumnHeader(
          "Footprint", "footprint", stringFieldCompareClosure(footprintIndex)));
      } else if (column === "Quantity" && settings.bommode == "grouped") {
        tr.appendChild(createColumnHeader("Quantity", "quantity", (a, b) => {
          return a.length - b.length;
        }));
      } else {
        // Other fields
        var i = config.fields.indexOf(column);
        if (i < 0)
          return;
        tr.appendChild(createColumnHeader(
          column, `field${i + 1}`, stringFieldCompareClosure(i)));
      }
    });
  }
  bomhead.appendChild(tr);
}

function populateBomBody(placeholderColumn = null, placeHolderElements = null) {
  while (bom.firstChild) {
    bom.removeChild(bom.firstChild);
  }
  highlightHandlers = [];
  footprintIndexToHandler = {};
  netsToHandler = {};
  currentHighlightedRowId = null;
  var first = true;
  if (settings.bommode == "netlist") {
    bomtable = pcbdata.nets.slice();
  } else {
    switch (settings.canvaslayout) {
      case 'F':
        bomtable = pcbdata.bom.F.slice();
        break;
      case 'FB':
        bomtable = pcbdata.bom.both.slice();
        break;
      case 'B':
        bomtable = pcbdata.bom.B.slice();
        break;
    }
    if (settings.bommode == "ungrouped") {
      // expand bom table
      expandedTable = []
      for (var bomentry of bomtable) {
        for (var ref of bomentry) {
          expandedTable.push([ref]);
        }
      }
      bomtable = expandedTable;
    }
  }
  if (bomSortFunction) {
    bomtable = bomtable.sort(bomSortFunction);
  }
  for (var i in bomtable) {
    var bomentry = bomtable[i];
    if (filter && !entryMatches(bomentry)) {
      continue;
    }
    var references = null;
    var netname = null;
    var tr = document.createElement("TR");
    var td = document.createElement("TD");
    var rownum = +i + 1;
    tr.id = "bomrow" + rownum;
    td.textContent = rownum;
    tr.appendChild(td);
    if (settings.bommode == "netlist") {
      netname = bomentry;
      td = document.createElement("TD");
      td.innerHTML = highlightFilter(netname ? netname : "&lt;no net&gt;");
      tr.appendChild(td);
    } else {
      if (reflookup) {
        references = findRefInEntry(bomentry);
        if (references.length == 0) {
          continue;
        }
      } else {
        references = bomentry;
      }
      // Filter hidden columns
      var columns = settings.columnOrder.filter(e => !settings.hiddenColumns.includes(e));
      columns.forEach((column) => {
        if (column === placeholderColumn) {
          var n = 1;
          if (column === "checkboxes")
            n = settings.checkboxes.length;
          for (i = 0; i < n; i++) {
            td = placeHolderElements.shift();
            tr.appendChild(td);
          }
          return;
        } else if (column === "checkboxes") {
          for (var checkbox of settings.checkboxes) {
            if (checkbox) {
              td = document.createElement("TD");
              var input = document.createElement("input");
              input.type = "checkbox";
              input.onchange = createCheckboxChangeHandler(checkbox, references, tr);
              setBomCheckboxState(checkbox, input, references);
              if (input.checked && settings.markWhenChecked == checkbox) {
                tr.classList.add("checked");
              }
              td.appendChild(input);
              tr.appendChild(td);
            }
          }
        } else if (column === "References") {
          td = document.createElement("TD");
          td.innerHTML = highlightFilter(references.map(r => r[0]).join(", "));
          tr.appendChild(td);
        } else if (column === "Quantity" && settings.bommode == "grouped") {
          // Quantity
          td = document.createElement("TD");
          td.textContent = references.length;
          tr.appendChild(td);
        } else {
          // All the other fields
          var field_index = config.fields.indexOf(column)
          if (field_index < 0)
            return;
          var valueSet = new Set();
          references.map(r => r[1]).forEach((id) => valueSet.add(pcbdata.bom.fields[id][field_index]));
          td = document.createElement("TD");
          td.innerHTML = highlightFilter(Array.from(valueSet).join(", "));
          tr.appendChild(td);
        }
      });
    }
    bom.appendChild(tr);
    var handler = createRowHighlightHandler(tr.id, references, netname);
    tr.onmousemove = handler;
    highlightHandlers.push({
      id: tr.id,
      handler: handler,
    });
    if (references !== null) {
      for (var refIndex of references.map(r => r[1])) {
        footprintIndexToHandler[refIndex] = handler;
      }
    }
    if (netname !== null) {
      netsToHandler[netname] = handler;
    }
    if ((filter || reflookup) && first) {
      handler();
      first = false;
    }
  }
  EventHandler.emitEvent(
    IBOM_EVENT_TYPES.BOM_BODY_CHANGE_EVENT, {
    filter: filter,
    reflookup: reflookup,
    checkboxes: settings.checkboxes,
    bommode: settings.bommode,
  });
}

function highlightPreviousRow() {
  if (!currentHighlightedRowId) {
    highlightHandlers[highlightHandlers.length - 1].handler();
  } else {
    if (highlightHandlers.length > 1 &&
      highlightHandlers[0].id == currentHighlightedRowId) {
      highlightHandlers[highlightHandlers.length - 1].handler();
    } else {
      for (var i = 0; i < highlightHandlers.length - 1; i++) {
        if (highlightHandlers[i + 1].id == currentHighlightedRowId) {
          highlightHandlers[i].handler();
          break;
        }
      }
    }
  }
  smoothScrollToRow(currentHighlightedRowId);
}

function highlightNextRow() {
  if (!currentHighlightedRowId) {
    highlightHandlers[0].handler();
  } else {
    if (highlightHandlers.length > 1 &&
      highlightHandlers[highlightHandlers.length - 1].id == currentHighlightedRowId) {
      highlightHandlers[0].handler();
    } else {
      for (var i = 1; i < highlightHandlers.length; i++) {
        if (highlightHandlers[i - 1].id == currentHighlightedRowId) {
          highlightHandlers[i].handler();
          break;
        }
      }
    }
  }
  smoothScrollToRow(currentHighlightedRowId);
}

function populateBomTable() {
  populateBomHeader();
  populateBomBody();
  setBomHandlers();
  resizableGrid(bomhead);
}

function footprintsClicked(footprintIndexes) {
  var lastClickedIndex = footprintIndexes.indexOf(lastClicked);
  for (var i = 1; i <= footprintIndexes.length; i++) {
    var refIndex = footprintIndexes[(lastClickedIndex + i) % footprintIndexes.length];
    if (refIndex in footprintIndexToHandler) {
      lastClicked = refIndex;
      footprintIndexToHandler[refIndex]();
      smoothScrollToRow(currentHighlightedRowId);
      break;
    }
  }
}

function netClicked(net) {
  if (net in netsToHandler) {
    netsToHandler[net]();
    smoothScrollToRow(currentHighlightedRowId);
  } else {
    clearHighlightedFootprints();
    highlightedNet = net;
    drawHighlights();
  }
}

function updateFilter(input) {
  filter = input.toLowerCase();
  populateBomTable();
}

function updateRefLookup(input) {
  reflookup = input.toLowerCase();
  populateBomTable();
}

function changeCanvasLayout(layout) {
  document.getElementById("fl-btn").classList.remove("depressed");
  document.getElementById("fb-btn").classList.remove("depressed");
  document.getElementById("bl-btn").classList.remove("depressed");
  switch (layout) {
    case 'F':
      document.getElementById("fl-btn").classList.add("depressed");
      if (settings.bomlayout != "bom-only") {
        canvassplit.collapse(1);
      }
      break;
    case 'B':
      document.getElementById("bl-btn").classList.add("depressed");
      if (settings.bomlayout != "bom-only") {
        canvassplit.collapse(0);
      }
      break;
    default:
      document.getElementById("fb-btn").classList.add("depressed");
      if (settings.bomlayout != "bom-only") {
        canvassplit.setSizes([50, 50]);
      }
  }
  settings.canvaslayout = layout;
  writeStorage("canvaslayout", layout);
  resizeAll();
  changeBomMode(settings.bommode);
}

function populateMetadata() {
  document.getElementById("title").innerHTML = pcbdata.metadata.title;
  document.getElementById("revision").innerHTML = "Rev: " + pcbdata.metadata.revision;
  document.getElementById("company").innerHTML = pcbdata.metadata.company;
  document.getElementById("filedate").innerHTML = pcbdata.metadata.date;
  if (pcbdata.metadata.title != "") {
    document.title = pcbdata.metadata.title + " BOM";
  }
  // Calculate board stats
  var fp_f = 0,
    fp_b = 0,
    pads_f = 0,
    pads_b = 0,
    pads_th = 0;
  for (var i = 0; i < pcbdata.footprints.length; i++) {
    if (pcbdata.bom.skipped.includes(i)) continue;
    var mod = pcbdata.footprints[i];
    if (mod.layer == "F") {
      fp_f++;
    } else {
      fp_b++;
    }
    for (var pad of mod.pads) {
      if (pad.type == "th") {
        pads_th++;
      } else {
        if (pad.layers.includes("F")) {
          pads_f++;
        }
        if (pad.layers.includes("B")) {
          pads_b++;
        }
      }
    }
  }
  document.getElementById("stats-components-front").innerHTML = fp_f;
  document.getElementById("stats-components-back").innerHTML = fp_b;
  document.getElementById("stats-components-total").innerHTML = fp_f + fp_b;
  document.getElementById("stats-groups-front").innerHTML = pcbdata.bom.F.length;
  document.getElementById("stats-groups-back").innerHTML = pcbdata.bom.B.length;
  document.getElementById("stats-groups-total").innerHTML = pcbdata.bom.both.length;
  document.getElementById("stats-smd-pads-front").innerHTML = pads_f;
  document.getElementById("stats-smd-pads-back").innerHTML = pads_b;
  document.getElementById("stats-smd-pads-total").innerHTML = pads_f + pads_b;
  document.getElementById("stats-th-pads").innerHTML = pads_th;
  // Update version string
  document.getElementById("github-link").innerHTML = "InteractiveHtmlBom&nbsp;" +
    /^v\d+\.\d+/.exec(pcbdata.ibom_version)[0];
}

function changeBomLayout(layout) {
  document.getElementById("bom-btn").classList.remove("depressed");
  document.getElementById("lr-btn").classList.remove("depressed");
  document.getElementById("tb-btn").classList.remove("depressed");
  switch (layout) {
    case 'bom-only':
      document.getElementById("bom-btn").classList.add("depressed");
      if (bomsplit) {
        bomsplit.destroy();
        bomsplit = null;
        canvassplit.destroy();
        canvassplit = null;
      }
      document.getElementById("frontcanvas").style.display = "none";
      document.getElementById("backcanvas").style.display = "none";
      document.getElementById("bot").style.height = "";
      break;
    case 'top-bottom':
      document.getElementById("tb-btn").classList.add("depressed");
      document.getElementById("frontcanvas").style.display = "";
      document.getElementById("backcanvas").style.display = "";
      document.getElementById("bot").style.height = "calc(100% - 80px)";
      document.getElementById("bomdiv").classList.remove("split-horizontal");
      document.getElementById("canvasdiv").classList.remove("split-horizontal");
      document.getElementById("frontcanvas").classList.add("split-horizontal");
      document.getElementById("backcanvas").classList.add("split-horizontal");
      if (bomsplit) {
        bomsplit.destroy();
        bomsplit = null;
        canvassplit.destroy();
        canvassplit = null;
      }
      bomsplit = Split(['#bomdiv', '#canvasdiv'], {
        sizes: [50, 50],
        onDragEnd: resizeAll,
        direction: "vertical",
        gutterSize: 5
      });
      canvassplit = Split(['#frontcanvas', '#backcanvas'], {
        sizes: [50, 50],
        gutterSize: 5,
        onDragEnd: resizeAll
      });
      break;
    case 'left-right':
      document.getElementById("lr-btn").classList.add("depressed");
      document.getElementById("frontcanvas").style.display = "";
      document.getElementById("backcanvas").style.display = "";
      document.getElementById("bot").style.height = "calc(100% - 80px)";
      document.getElementById("bomdiv").classList.add("split-horizontal");
      document.getElementById("canvasdiv").classList.add("split-horizontal");
      document.getElementById("frontcanvas").classList.remove("split-horizontal");
      document.getElementById("backcanvas").classList.remove("split-horizontal");
      if (bomsplit) {
        bomsplit.destroy();
        bomsplit = null;
        canvassplit.destroy();
        canvassplit = null;
      }
      bomsplit = Split(['#bomdiv', '#canvasdiv'], {
        sizes: [50, 50],
        onDragEnd: resizeAll,
        gutterSize: 5
      });
      canvassplit = Split(['#frontcanvas', '#backcanvas'], {
        sizes: [50, 50],
        gutterSize: 5,
        direction: "vertical",
        onDragEnd: resizeAll
      });
  }
  settings.bomlayout = layout;
  writeStorage("bomlayout", layout);
  changeCanvasLayout(settings.canvaslayout);
}

function changeBomMode(mode) {
  document.getElementById("bom-grouped-btn").classList.remove("depressed");
  document.getElementById("bom-ungrouped-btn").classList.remove("depressed");
  document.getElementById("bom-netlist-btn").classList.remove("depressed");
  var chkbxs = document.getElementsByClassName("visibility_checkbox");

  switch (mode) {
    case 'grouped':
      document.getElementById("bom-grouped-btn").classList.add("depressed");
      for (var i = 0; i < chkbxs.length; i++) {
        chkbxs[i].disabled = false;
      }
      break;
    case 'ungrouped':
      document.getElementById("bom-ungrouped-btn").classList.add("depressed");
      for (var i = 0; i < chkbxs.length; i++) {
        chkbxs[i].disabled = false;
      }
      break;
    case 'netlist':
      document.getElementById("bom-netlist-btn").classList.add("depressed");
      for (var i = 0; i < chkbxs.length; i++) {
        chkbxs[i].disabled = true;
      }
  }

  writeStorage("bommode", mode);
  if (mode != settings.bommode) {
    settings.bommode = mode;
    bomSortFunction = null;
    currentSortColumn = null;
    currentSortOrder = null;
    clearHighlightedFootprints();
  }
  populateBomTable();
}

function focusFilterField() {
  focusInputField(document.getElementById("filter"));
}

function focusRefLookupField() {
  focusInputField(document.getElementById("reflookup"));
}

function toggleBomCheckbox(bomrowid, checkboxnum) {
  if (!bomrowid || checkboxnum > settings.checkboxes.length) {
    return;
  }
  var bomrow = document.getElementById(bomrowid);
  var checkbox = bomrow.childNodes[checkboxnum].childNodes[0];
  checkbox.checked = !checkbox.checked;
  checkbox.indeterminate = false;
  checkbox.onchange();
}

function checkBomCheckbox(bomrowid, checkboxname) {
  var checkboxnum = 0;
  while (checkboxnum < settings.checkboxes.length &&
    settings.checkboxes[checkboxnum].toLowerCase() != checkboxname.toLowerCase()) {
    checkboxnum++;
  }
  if (!bomrowid || checkboxnum >= settings.checkboxes.length) {
    return;
  }
  var bomrow = document.getElementById(bomrowid);
  var checkbox = bomrow.childNodes[checkboxnum + 1].childNodes[0];
  checkbox.checked = true;
  checkbox.indeterminate = false;
  checkbox.onchange();
}

function setBomCheckboxes(value) {
  writeStorage("bomCheckboxes", value);
  settings.checkboxes = value.split(",").map((e) => e.trim()).filter((e) => e);
  prepCheckboxes();
  populateMarkWhenCheckedOptions();
  setMarkWhenChecked(settings.markWhenChecked);
}

function setMarkWhenChecked(value) {
  writeStorage("markWhenChecked", value);
  settings.markWhenChecked = value;
  markedFootprints.clear();
  for (var ref of (value ? getStoredCheckboxRefs(value) : [])) {
    markedFootprints.add(ref);
  }
  populateBomTable();
  drawHighlights();
}

function prepCheckboxes() {
  var table = document.getElementById("checkbox-stats");
  while (table.childElementCount > 1) {
    table.removeChild(table.lastChild);
  }
  if (settings.checkboxes.length) {
    table.style.display = "";
  } else {
    table.style.display = "none";
  }
  for (var checkbox of settings.checkboxes) {
    var tr = document.createElement("TR");
    var td = document.createElement("TD");
    td.innerHTML = checkbox;
    tr.appendChild(td);
    td = document.createElement("TD");
    td.id = "checkbox-stats-" + checkbox;
    var progressbar = document.createElement("div");
    progressbar.classList.add("bar");
    td.appendChild(progressbar);
    var text = document.createElement("div");
    text.classList.add("text");
    td.appendChild(text);
    tr.appendChild(td);
    table.appendChild(tr);
    updateCheckboxStats(checkbox);
  }
}

function populateMarkWhenCheckedOptions() {
  var container = document.getElementById("markWhenCheckedContainer");

  if (settings.checkboxes.length == 0) {
    container.parentElement.style.display = "none";
    return;
  }

  container.innerHTML = '';
  container.parentElement.style.display = "inline-block";

  function createOption(name, displayName) {
    var id = "markWhenChecked-" + name;

    var div = document.createElement("div");
    div.classList.add("radio-container");

    var input = document.createElement("input");
    input.type = "radio";
    input.name = "markWhenChecked";
    input.value = name;
    input.id = id;
    input.onchange = () => setMarkWhenChecked(name);
    div.appendChild(input);

    // Preserve the selected element when the checkboxes change
    if (name == settings.markWhenChecked) {
      input.checked = true;
    }

    var label = document.createElement("label");
    label.innerHTML = displayName;
    label.htmlFor = id;
    div.appendChild(label);

    container.appendChild(div);
  }
  createOption("", "None");
  for (var checkbox of settings.checkboxes) {
    createOption(checkbox, checkbox);
  }
}

function updateCheckboxStats(checkbox) {
  var checked = getStoredCheckboxRefs(checkbox).size;
  var total = pcbdata.footprints.length - pcbdata.bom.skipped.length;
  var percent = checked * 100.0 / total;
  var td = document.getElementById("checkbox-stats-" + checkbox);
  td.firstChild.style.width = percent + "%";
  td.lastChild.innerHTML = checked + "/" + total + " (" + Math.round(percent) + "%)";
}

document.onkeydown = function (e) {
  switch (e.key) {
    case "n":
      if (document.activeElement.type == "text") {
        return;
      }
      if (currentHighlightedRowId !== null) {
        checkBomCheckbox(currentHighlightedRowId, "placed");
        highlightNextRow();
        e.preventDefault();
      }
      break;
    case "ArrowUp":
      highlightPreviousRow();
      e.preventDefault();
      break;
    case "ArrowDown":
      highlightNextRow();
      e.preventDefault();
      break;
    default:
      break;
  }
  if (e.altKey) {
    switch (e.key) {
      case "f":
        focusFilterField();
        e.preventDefault();
        break;
      case "r":
        focusRefLookupField();
        e.preventDefault();
        break;
      case "z":
        changeBomLayout("bom-only");
        e.preventDefault();
        break;
      case "x":
        changeBomLayout("left-right");
        e.preventDefault();
        break;
      case "c":
        changeBomLayout("top-bottom");
        e.preventDefault();
        break;
      case "v":
        changeCanvasLayout("F");
        e.preventDefault();
        break;
      case "b":
        changeCanvasLayout("FB");
        e.preventDefault();
        break;
      case "n":
        changeCanvasLayout("B");
        e.preventDefault();
        break;
      default:
        break;
    }
    if (e.key >= '1' && e.key <= '9') {
      toggleBomCheckbox(currentHighlightedRowId, parseInt(e.key));
      e.preventDefault();
    }
  }
}

function hideNetlistButton() {
  document.getElementById("bom-ungrouped-btn").classList.remove("middle-button");
  document.getElementById("bom-ungrouped-btn").classList.add("right-most-button");
  document.getElementById("bom-netlist-btn").style.display = "none";
}

window.onload = function (e) {
  initUtils();
  initRender();
  initStorage();
  initDefaults();
  cleanGutters();
  populateMetadata();
  dbgdiv = document.getElementById("dbg");
  bom = document.getElementById("bombody");
  bomhead = document.getElementById("bomhead");
  filter = "";
  reflookup = "";
  if (!("nets" in pcbdata)) {
    hideNetlistButton();
  }
  initDone = true;
  setBomCheckboxes(document.getElementById("bomCheckboxes").value);
  // Triggers render
  changeBomLayout(settings.bomlayout);

  // Users may leave fullscreen without touching the checkbox. Uncheck.
  document.addEventListener('fullscreenchange', () => {
    if (!document.fullscreenElement)
      document.getElementById('fullscreenCheckbox').checked = false;
  });
}

window.onresize = resizeAll;
window.matchMedia("print").addListener(resizeAll);

///////////////////////////////////////////////

///////////////////////////////////////////////

///////////////////////////////////////////////
  </script>
</head>

<body>

<div id="topmostdiv" class="topmostdiv">
  <div id="top">
    <div style="float: right; height: 100%;">
      <div class="hideonprint menu" style="float: right; top: 8px;">
        <button class="menubtn"></button>
        <div class="menu-content">
          <label class="menu-label menu-label-top" style="width: calc(50% - 18px)">
            <input id="darkmodeCheckbox" type="checkbox" onchange="setDarkMode(this.checked)">
            Dark mode
          </label><!-- This comment eats space! All of it!
          --><label class="menu-label menu-label-top" style="width: calc(50% - 17px); border-left: 0;">
            <input id="fullscreenCheckbox" type="checkbox" onchange="setFullscreen(this.checked)">
            Full Screen
          </label>
          <label class="menu-label" style="width: calc(50% - 18px)">
            <input id="fabricationCheckbox" type="checkbox" checked onchange="fabricationVisible(this.checked)">
            Fab layer
          </label><!-- This comment eats space! All of it!
          --><label class="menu-label" style="width: calc(50% - 17px); border-left: 0;">
            <input id="silkscreenCheckbox" type="checkbox" checked onchange="silkscreenVisible(this.checked)">
            Silkscreen
          </label>
          <label class="menu-label" style="width: calc(50% - 18px)">
            <input id="referencesCheckbox" type="checkbox" checked onchange="referencesVisible(this.checked)">
            References
          </label><!-- This comment eats space! All of it!
          --><label class="menu-label" style="width: calc(50% - 17px); border-left: 0;">
            <input id="valuesCheckbox" type="checkbox" checked onchange="valuesVisible(this.checked)">
            Values
          </label>
          <div id="tracksAndZonesCheckboxes">
            <label class="menu-label" style="width: calc(50% - 18px)">
              <input id="tracksCheckbox" type="checkbox" checked onchange="tracksVisible(this.checked)">
              Tracks
            </label><!-- This comment eats space! All of it!
            --><label class="menu-label" style="width: calc(50% - 17px); border-left: 0;">
              <input id="zonesCheckbox" type="checkbox" checked onchange="zonesVisible(this.checked)">
              Zones
            </label>
          </div>
          <label class="menu-label" style="width: calc(50% - 18px)">
            <input id="padsCheckbox" type="checkbox" checked onchange="padsVisible(this.checked)">
            Pads
          </label><!-- This comment eats space! All of it!
          --><label class="menu-label" style="width: calc(50% - 17px); border-left: 0;">
            <input id="dnpOutlineCheckbox" type="checkbox" checked onchange="dnpOutline(this.checked)">
            DNP outlined
          </label>
          <label class="menu-label">
            <input id="highlightpin1Checkbox" type="checkbox" onchange="setHighlightPin1(this.checked)">
            Highlight first pin
          </label>
          <label class="menu-label">
            <input id="dragCheckbox" type="checkbox" checked onchange="setRedrawOnDrag(this.checked)">
            Continuous redraw on drag
          </label>
          <label class="menu-label">
            <span>Board rotation</span>
            <span style="float: right"><span id="rotationDegree">0</span>&#176;</span>
            <input id="boardRotation" type="range" min="-36" max="36" value="0" class="slider" oninput="setBoardRotation(this.value)">
          </label>
          <label class="menu-label">
            <div style="margin-left: 5px">Bom checkboxes</div>
            <input id="bomCheckboxes" class="menu-textbox" type=text
                   oninput="setBomCheckboxes(this.value)">
          </label>
          <label class="menu-label">
            <div style="margin-left: 5px">Mark when checked</div>
            <div id="markWhenCheckedContainer"></div>
          </label>
          <label class="menu-label">
            <span class="shameless-plug">
              <span>Created using</span>
              <a id="github-link" target="blank" href="https://github.com/openscopeproject/InteractiveHtmlBom">InteractiveHtmlBom</a>
            </span>
          </label>
        </div>
      </div>
      <div class="button-container hideonprint"
           style="float: right; position: relative; top: 8px">
        <button id="fl-btn" class="left-most-button" onclick="changeCanvasLayout('F')"
                title="Front only">F
        </button>
        <button id="fb-btn" class="middle-button" onclick="changeCanvasLayout('FB')"
                title="Front and Back">FB
        </button>
        <button id="bl-btn" class="right-most-button" onclick="changeCanvasLayout('B')"
                title="Back only">B
        </button>
      </div>
      <div class="button-container hideonprint"
           style="float: right; position: relative; top: 8px">
        <button id="bom-btn" class="left-most-button" onclick="changeBomLayout('bom-only')"
                title="BOM only"></button>
        <button id="lr-btn" class="middle-button" onclick="changeBomLayout('left-right')"
                title="BOM left, drawings right"></button>
        <button id="tb-btn" class="right-most-button" onclick="changeBomLayout('top-bottom')"
                title="BOM top, drawings bot"></button>
      </div>
      <div class="button-container hideonprint"
           style="float: right; position: relative; top: 8px">
        <button id="bom-grouped-btn" class="left-most-button" onclick="changeBomMode('grouped')"
                title="Grouped BOM"></button>
        <button id="bom-ungrouped-btn" class="middle-button" onclick="changeBomMode('ungrouped')"
                title="Ungrouped BOM"></button>
        <button id="bom-netlist-btn" class="right-most-button" onclick="changeBomMode('netlist')"
                title="Netlist"></button>
      </div>
      <div class="hideonprint menu" style="float: right; top: 8px;">
        <button class="statsbtn"></button>
        <div class="menu-content">
          <table class="stats">
            <tbody>
              <tr>
                <td width="40%">Board stats</td>
                <td>Front</td>
                <td>Back</td>
                <td>Total</td>
              </tr>
              <tr>
                <td>Components</td>
                <td id="stats-components-front">~</td>
                <td id="stats-components-back">~</td>
                <td id="stats-components-total">~</td>
              </tr>
              <tr>
                <td>Groups</td>
                <td id="stats-groups-front">~</td>
                <td id="stats-groups-back">~</td>
                <td id="stats-groups-total">~</td>
              </tr>
              <tr>
                <td>SMD pads</td>
                <td id="stats-smd-pads-front">~</td>
                <td id="stats-smd-pads-back">~</td>
                <td id="stats-smd-pads-total">~</td>
              </tr>
              <tr>
                <td>TH pads</td>
                <td colspan=3 id="stats-th-pads">~</td>
              </tr>
            </tbody>
          </table>
          <table class="stats">
            <col width="40%"/><col />
            <tbody id="checkbox-stats">
              <tr>
                <td colspan=2 style="border-top: 0">Checkboxes</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
      <div class="hideonprint menu" style="float: right; top: 8px;">
        <button class="iobtn"></button>
        <div class="menu-content">
          <div class="menu-label menu-label-top">
            <div style="margin-left: 5px;">Save board image</div>
            <div class="flexbox">
              <input id="render-save-width" class="menu-textbox" type="text" value="1000" placeholder="Width"
                  style="flex-grow: 1; width: 50px;" oninput="validateSaveImgDimension(this)">
              <span>X</span>
              <input id="render-save-height" class="menu-textbox" type="text" value="1000" placeholder="Height"
                  style="flex-grow: 1; width: 50px;" oninput="validateSaveImgDimension(this)">
            </div>
            <label>
              <input id="render-save-transparent" type="checkbox">
              Transparent background
            </label>
            <div class="flexbox">
              <button class="savebtn" onclick="saveImage('F')">Front</button>
              <button class="savebtn" onclick="saveImage('B')">Back</button>
            </div>
          </div>
          <div class="menu-label">
            <span style="margin-left: 5px;">Config and checkbox state</span>
            <div class="flexbox">
              <button class="savebtn" onclick="saveSettings()">Export</button>
              <button class="savebtn" onclick="loadSettings()">Import</button>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div id="fileinfodiv" style="overflow: auto;">
      <table class="fileinfo">
        <tbody>
          <tr>
            <td id="title" class="title" style="width: 70%">
              Title
            </td>
            <td id="revision" class="title" style="width: 30%">
              Revision
            </td>
          </tr>
          <tr>
            <td id="company">
              Company
            </td>
            <td id="filedate">
              Date
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
  <div id="bot" class="split" style="height: calc(100% - 80px)">
    <div id="bomdiv" class="split split-horizontal">
      <div style="width: 100%">
        <input id="reflookup" class="textbox searchbox reflookup hideonprint" type="text" placeholder="Ref lookup"
               oninput="updateRefLookup(this.value)">
        <input id="filter" class="textbox searchbox filter hideonprint" type="text" placeholder="Filter"
               oninput="updateFilter(this.value)">
        <div class="button-container hideonprint" style="float: left; margin: 0;">
          <button id="copy" title="Copy bom table to clipboard"
               onclick="copyToClipboard()"></button>
        </div>
      </div>
      <div id="dbg"></div>
      <table class="bom" id="bomtable">
        <thead id="bomhead">
        </thead>
        <tbody id="bombody">
        </tbody>
      </table>
    </div>
    <div id="canvasdiv" class="split split-horizontal">
      <div id="frontcanvas" class="split" touch-action="none" style="overflow: hidden">
        <div style="position: relative; width: 100%; height: 100%;">
          <canvas id="F_bg" style="position: absolute; left: 0; top: 0; z-index: 0;"></canvas>
          <canvas id="F_fab" style="position: absolute; left: 0; top: 0; z-index: 1;"></canvas>
          <canvas id="F_slk" style="position: absolute; left: 0; top: 0; z-index: 2;"></canvas>
          <canvas id="F_hl" style="position: absolute; left: 0; top: 0; z-index: 3;"></canvas>
        </div>
      </div>
      <div id="backcanvas" class="split" touch-action="none" style="overflow: hidden">
        <div style="position: relative; width: 100%; height: 100%;">
          <canvas id="B_bg" style="position: absolute; left: 0; top: 0; z-index: 0;"></canvas>
          <canvas id="B_fab" style="position: absolute; left: 0; top: 0; z-index: 1;"></canvas>
          <canvas id="B_slk" style="position: absolute; left: 0; top: 0; z-index: 2;"></canvas>
          <canvas id="B_hl" style="position: absolute; left: 0; top: 0; z-index: 3;"></canvas>
        </div>
      </div>
    </div>
  </div>
</div>

</body>

</html>
